{"paragraphs":[{"text":"import java.io.File\nimport scala.io.Source\njavascript:void(0)\nimport org.apache.log4j.Logger\nimport org.apache.log4j.Level\n\nimport org.apache.spark.SparkConf\nimport org.apache.spark.SparkContext\nimport org.apache.spark.SparkContext._\nimport org.apache.spark.rdd._\nimport org.apache.spark.ml.fpm.FPGrowth\nimport org.apache.spark.mllib.recommendation.{ALS, Rating, MatrixFactorizationModel}\n\n\n","user":"anonymous","dateUpdated":"2018-12-20T09:07:47+0000","config":{"tableHide":false,"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"import java.io.File\nimport scala.io.Source\nimport org.apache.log4j.Logger\nimport org.apache.log4j.Level\nimport org.apache.spark.SparkConf\nimport org.apache.spark.SparkContext\nimport org.apache.spark.SparkContext._\nimport org.apache.spark.rdd._\nimport org.apache.spark.ml.fpm.FPGrowth\nimport org.apache.spark.mllib.recommendation.{ALS, Rating, MatrixFactorizationModel}\n"}]},"apps":[],"jobName":"paragraph_1545296867394_979853634","id":"20181130-015357_1908866909","dateCreated":"2018-12-20T09:07:47+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:5690"},{"text":"val transaction_basket = spark.read.option(\"header\",\"true\").csv(\"s3://input-smart-find/Quotations-110818-S.csv\")","user":"anonymous","dateUpdated":"2018-12-20T09:10:37+0000","config":{"tableHide":false,"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"transaction_basket: org.apache.spark.sql.DataFrame = [Quotation: Quotation ID: string, Quotation: Created Date: string ... 10 more fields]\n"}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://ip-172-31-35-197.ec2.internal:4040/jobs/job?id=1135"],"interpreterSettingId":"spark"}},"apps":[],"jobName":"paragraph_1545296867394_1997444107","id":"20181130-025906_2104350062","dateCreated":"2018-12-20T09:07:47+0000","dateStarted":"2018-12-20T09:10:37+0000","dateFinished":"2018-12-20T09:10:48+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:5691"},{"text":"val product_description = spark.read.option(\"header\",\"true\").csv(\"s3://input-smart-find/products - 110818-s.csv\").select($\"Product Family\".alias(\"product\"), $\"Product Description\".alias(\"product_description\"))","user":"anonymous","dateUpdated":"2018-12-20T10:37:17+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"product_description: org.apache.spark.sql.DataFrame = [product: string, product_description: string]\n"}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://ip-172-31-35-197.ec2.internal:4040/jobs/job?id=1218"],"interpreterSettingId":"spark"}},"apps":[],"jobName":"paragraph_1545301857510_-1872854555","id":"20181220-103057_437606755","dateCreated":"2018-12-20T10:30:57+0000","dateStarted":"2018-12-20T10:37:17+0000","dateFinished":"2018-12-20T10:37:26+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:5692"},{"text":"//val product_mapping_description = product_mapping.join(product_description, Seq(\"product\"),\"left_outer\")\n//product_mapping_description.show(5)\nproduct_mapping_description.filter(\"productID < 20\").sort($\"productID\".asc).show(false)","user":"anonymous","dateUpdated":"2018-12-20T10:48:37+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{"0":{"graph":{"mode":"table","height":324,"optionOpen":false}}},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+----------+---------+--------------------------------------+\n|product   |productID|product_description                   |\n+----------+---------+--------------------------------------+\n|4X40E77328|0.0      |CASE_BO Essential Top load            |\n|40A90090EU|1.0      |Thinkpad USB-C Dock                   |\n|4XA0E97775|2.0      |ODD_BO TP UltraSlim USB DVD Burner    |\n|40A90090UK|3.0      |Thinkpad USB-C Dock                   |\n|4X40E77329|4.0      |CASE_BO Essential Backpack            |\n|06P4069   |5.0      |MOUSE OPTICAL WHEEL                   |\n|40AH0135EU|6.0      |Pro Dock - 135 W (EU)                 |\n|61A6MAT3EU|7.0      |T24i-10 -23.8 inch Monitor            |\n|4Y50R20863|8.0      |MICE_BO Lenovo Essential USB Mouse    |\n|40AC0135EU|9.0      |Thunderbolt Dock - EU                 |\n|0B47069   |10.0     |ADAPTR HDMI to VGA monitor adapter    |\n|40AF0135UK|11.0     |TP Hybrid usb-c dock-uk               |\n|4X90M60789|12.0     |CABLE_BO Lenovo USB C Travel  Hub     |\n|40AJ0135EU|13.0     |Ultra Dock - 135 W (EU)               |\n|40A20090EU|14.0     |ThinkPad Ultra Dock-90 W              |\n|4X70M60574|15.0     |MEMORY_BO 8GB DDR4 2400MHz SoDIMM     |\n|46C3447   |16.0     |SFP+ SR Transceiver                   |\n|10R1PAT1UK|17.0     |TIO22Gen3-Monitor(22inch,DP&3in1 port)|\n|57Y4303   |18.0     |LOCK Cable Lock                       |\n|40AG0090EU|19.0     |Basic Dock - 90 W (EU)                |\n+----------+---------+--------------------------------------+\n\n"}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://ip-172-31-35-197.ec2.internal:4040/jobs/job?id=1227"],"interpreterSettingId":"spark"}},"apps":[],"jobName":"paragraph_1545302300338_-122381268","id":"20181220-103820_1815969032","dateCreated":"2018-12-20T10:38:20+0000","dateStarted":"2018-12-20T10:47:44+0000","dateFinished":"2018-12-20T10:48:16+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:5693"},{"text":"transaction.printSchema()\nprintln(transaction_basket.first)\ntransaction.show(10)","user":"anonymous","dateUpdated":"2018-12-20T09:10:37+0000","config":{"tableHide":false,"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"root\n |-- Quotation: Quotation ID: string (nullable = true)\n |-- Quotation: Created Date: string (nullable = true)\n |-- Quotation: Record Type: string (nullable = true)\n |-- Display Net Price Currency: string (nullable = true)\n |-- Display Net Price: string (nullable = true)\n |-- Display Quantity: string (nullable = true)\n |-- Contract Type: string (nullable = true)\n |-- Country: string (nullable = true)\n |-- Account ID: string (nullable = true)\n |-- Proposal Line Item: Line Item Id: string (nullable = true)\n |-- Product: Product Family: string (nullable = true)\n |-- Product: Offering Type: string (nullable = true)\n\n[Q-00024173,17/04/2018,MC,USD,134,1,Multi-Country,Austria,0010X000049HqwDQAS,QL-0001761882,00FE331,MTM]\n+-----------------------+-----------------------+----------------------+--------------------------+-----------------+----------------+-------------+-------+------------------+--------------------------------+-----------------------+----------------------+\n|Quotation: Quotation ID|Quotation: Created Date|Quotation: Record Type|Display Net Price Currency|Display Net Price|Display Quantity|Contract Type|Country|        Account ID|Proposal Line Item: Line Item Id|Product: Product Family|Product: Offering Type|\n+-----------------------+-----------------------+----------------------+--------------------------+-----------------+----------------+-------------+-------+------------------+--------------------------------+-----------------------+----------------------+\n|             Q-00024173|             17/04/2018|                    MC|                       USD|              134|               1|Multi-Country|Austria|0010X000049HqwDQAS|                   QL-0001761882|                00FE331|                   MTM|\n|             Q-00001314|             30/10/2017|                   CPQ|                       NOK|                0|               0|     Quantity| Norway|   0010X000049Hr7j|                   QL-0000027874|             20HD0002MX|                   MTM|\n|             Q-00046480|               2/7/2018|                   CPQ|                       EUR|             7200|              50|     Quantity| France|   001b0000002nq93|                   QL-0003721746|             40AJ0135IT|             Accessory|\n|             Q-00071753|             17/09/2018|                   CPQ|                       EUR|            67900|             100|     Quantity| France|   001b0000002nqUL|                   QL-0005540859|             20JU001GFR|                   MTM|\n|             Q-00002265|             15/11/2017|                   CPQ|                       EUR|              202|               2|     Quantity| France|   001b0000002nqz2|                   QL-0000098440|                40K9612|                   MTM|\n|             Q-00052761|             18/07/2018|                   CPQ|                       EUR|            10000|             100|     Quantity| France|   001b0000003Ws0i|                   QL-0004031341|             ZA2B0037SE|                   MTM|\n|             Q-00074715|             25/09/2018|                   CPQ|                       EUR|            45750|              50|     Quantity|Germany|   001b0000003Z6A3|                   QL-0005862303|             20L7001SGE|                   MTM|\n|             Q-00003868|              5/12/2017|                   CPQ|                       EUR|          9817.41|               1|     Quantity|Germany|   001b0000003Z7Fe|                   QL-0000294940|                93634RX|                   MTM|\n|             Q-00014320|               5/3/2018|                   CPQ|                       EUR|            14925|              25|     Quantity|  Spain|   001b000000PFEyl|                   QL-0001038373|             10MLS49400|                   MTM|\n|             Q-00043494|             24/06/2018|                   CPQ|                       DKK|           607700|              50| Non Quantity|Iceland|   001b000000da7ON|                   QL-0004037436|             30BYS1CK00|                   MTM|\n+-----------------------+-----------------------+----------------------+--------------------------+-----------------+----------------+-------------+-------+------------------+--------------------------------+-----------------------+----------------------+\nonly showing top 10 rows\n\n"}]},"apps":[],"jobName":"paragraph_1545296867394_-1091433872","id":"20181130-034130_1438264848","dateCreated":"2018-12-20T09:07:47+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:5694"},{"text":"transaction_basket.count()","user":"anonymous","dateUpdated":"2018-12-20T09:10:45+0000","config":{"tableHide":false,"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"res20: Long = 147218\n"}]},"apps":[],"jobName":"paragraph_1545296867394_1400397923","id":"20181130-034525_406570803","dateCreated":"2018-12-20T09:07:47+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:5695"},{"text":"//import org.apache.spark.sql.functions._\nval col = transaction_basket.select(\"Quotation: Quotation ID\", \"Product: Product Family\")\n//col.show(10)\n","user":"anonymous","dateUpdated":"2018-12-20T09:11:15+0000","config":{"tableHide":false,"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"col: org.apache.spark.sql.DataFrame = [Quotation: Quotation ID: string, Product: Product Family: string]\n"}]},"apps":[],"jobName":"paragraph_1545296867398_-125479646","id":"20181130-025303_1951509482","dateCreated":"2018-12-20T09:07:47+0000","dateStarted":"2018-12-20T09:11:15+0000","dateFinished":"2018-12-20T09:11:18+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:5696"},{"text":"val df = col.toDF()\ndf.show(10)\n","user":"anonymous","dateUpdated":"2018-12-20T09:07:47+0000","config":{"tableHide":false,"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"df: org.apache.spark.sql.DataFrame = [Quotation: Quotation ID: string, Product: Product Family: string]\n+-----------------------+-----------------------+\n|Quotation: Quotation ID|Product: Product Family|\n+-----------------------+-----------------------+\n|             Q-00024173|                00FE331|\n|             Q-00001314|             20HD0002MX|\n|             Q-00046480|             40AJ0135IT|\n|             Q-00071753|             20JU001GFR|\n|             Q-00002265|                40K9612|\n|             Q-00052761|             ZA2B0037SE|\n|             Q-00074715|             20L7001SGE|\n|             Q-00003868|                93634RX|\n|             Q-00014320|             10MLS49400|\n|             Q-00043494|             30BYS1CK00|\n+-----------------------+-----------------------+\nonly showing top 10 rows\n\n"}]},"apps":[],"jobName":"paragraph_1545296867398_1022455891","id":"20181130-054829_1819412352","dateCreated":"2018-12-20T09:07:47+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:5697"},{"text":"val to_id = col.join(product_mapping_description, col.col(\"Product: Product Family\") === product_mapping_description.col(\"product\")).select(\"Quotation: Quotation ID\",\"productID\")\n\n\nval basket = to_id.groupBy(\"Quotation: Quotation ID\").agg(collect_set(\"productID\").alias(\"Product_Family\")).toDF()\nval product = basket.select(\"Product_Family\")\n//product.count()\n\n","user":"anonymous","dateUpdated":"2018-12-20T11:07:44+0000","config":{"tableHide":false,"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"to_id: org.apache.spark.sql.DataFrame = [Quotation: Quotation ID: string, productID: double]\nbasket: org.apache.spark.sql.DataFrame = [Quotation: Quotation ID: string, Product_Family: array<double>]\nproduct: org.apache.spark.sql.DataFrame = [Product_Family: array<double>]\n"}]},"apps":[],"jobName":"paragraph_1545296867399_1799802935","id":"20181130-054948_2014093871","dateCreated":"2018-12-20T09:07:47+0000","dateStarted":"2018-12-20T11:07:44+0000","dateFinished":"2018-12-20T11:08:04+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:5698"},{"text":"//product.show(10)\nval fpgrowth = new FPGrowth().setItemsCol(\"Product_Family\").setMinSupport(0.001).setMinConfidence(0.5)\nval model_fpgrowth = fpgrowth.fit(product)","user":"anonymous","dateUpdated":"2018-12-20T11:07:49+0000","config":{"tableHide":false,"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"fpgrowth: org.apache.spark.ml.fpm.FPGrowth = fpgrowth_d0f7b49f4bae\nmodel_fpgrowth: org.apache.spark.ml.fpm.FPGrowthModel = fpgrowth_d0f7b49f4bae\n"}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://ip-172-31-35-197.ec2.internal:4040/jobs/job?id=1236","http://ip-172-31-35-197.ec2.internal:4040/jobs/job?id=1237","http://ip-172-31-35-197.ec2.internal:4040/jobs/job?id=1238"],"interpreterSettingId":"spark"}},"apps":[],"jobName":"paragraph_1545296867399_-1675334014","id":"20181130-081741_220636123","dateCreated":"2018-12-20T09:07:47+0000","dateStarted":"2018-12-20T11:07:49+0000","dateFinished":"2018-12-20T11:09:59+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:5699"},{"text":"model_fpgrowth.associationRules.show()\nmodel_fpgrowth.transform(product).show()","user":"anonymous","dateUpdated":"2018-12-20T11:07:50+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+--------------------+----------+------------------+\n|          antecedent|consequent|        confidence|\n+--------------------+----------+------------------+\n|             [405.0]|    [64.0]|              0.68|\n|[83.0, 77.0, 50.0...|     [0.0]|               1.0|\n|[83.0, 77.0, 50.0...|    [12.0]|0.9444444444444444|\n|[83.0, 77.0, 54.0...|    [50.0]|0.9714285714285714|\n|[83.0, 77.0, 54.0...|    [21.0]|               1.0|\n|[83.0, 77.0, 54.0...|     [0.0]|               1.0|\n|[65.0, 52.0, 21.0...|    [77.0]|               0.9|\n|[65.0, 52.0, 21.0...|    [83.0]|             0.875|\n|      [206.0, 181.0]|   [221.0]|0.5308641975308642|\n|      [206.0, 181.0]|   [261.0]|0.5555555555555556|\n|      [206.0, 181.0]|    [16.0]| 0.691358024691358|\n|      [206.0, 181.0]|    [28.0]|0.5802469135802469|\n|      [206.0, 181.0]|   [220.0]|0.9506172839506173|\n|      [206.0, 181.0]|   [367.0]|0.5185185185185185|\n|      [206.0, 181.0]|   [216.0]|0.9753086419753086|\n|[83.0, 50.0, 5.0,...|    [77.0]| 0.972972972972973|\n|[83.0, 50.0, 5.0,...|     [0.0]| 0.972972972972973|\n|[83.0, 50.0, 5.0,...|    [21.0]| 0.972972972972973|\n|[83.0, 50.0, 5.0,...|    [12.0]|0.9459459459459459|\n| [125.0, 35.0, 28.0]|    [16.0]|0.6119402985074627|\n+--------------------+----------+------------------+\nonly showing top 20 rows\n\n+--------------------+--------------------+\n|      Product_Family|          prediction|\n+--------------------+--------------------+\n|[1333.0, 218.0, 4...|             [409.0]|\n|[1013.0, 1133.0, ...|             [176.0]|\n|              [92.0]|                  []|\n|[0.0, 193.0, 23.0...|[24.0, 12.0, 83.0...|\n|              [54.0]|                  []|\n|[456.0, 1414.0, 9...|                  []|\n|   [0.0, 39.0, 43.0]|               [4.0]|\n|            [9797.0]|                  []|\n|           [23912.0]|                  []|\n|            [8802.0]|                  []|\n|         [0.0, 18.0]|                  []|\n|             [244.0]|                  []|\n|   [20833.0, 6337.0]|                  []|\n|           [17931.0]|                  []|\n|[0.0, 2103.0, 152...|                  []|\n|             [801.0]|                  []|\n|  [22707.0, 17405.0]|                  []|\n|    [483.0, 22634.0]|                  []|\n|            [2394.0]|                  []|\n|[9.0, 36.0, 1.0, ...|               [0.0]|\n+--------------------+--------------------+\nonly showing top 20 rows\n\n"}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://ip-172-31-35-197.ec2.internal:4040/jobs/job?id=1239","http://ip-172-31-35-197.ec2.internal:4040/jobs/job?id=1240","http://ip-172-31-35-197.ec2.internal:4040/jobs/job?id=1241","http://ip-172-31-35-197.ec2.internal:4040/jobs/job?id=1242"],"interpreterSettingId":"spark"}},"apps":[],"jobName":"paragraph_1545296867399_-1825904590","id":"20181130-095547_1224260958","dateCreated":"2018-12-20T09:07:47+0000","dateStarted":"2018-12-20T11:08:06+0000","dateFinished":"2018-12-20T11:13:24+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:5700"},{"text":"val mostPopularItemInABasket = model_fpgrowth.freqItemsets\nmostPopularItemInABasket.createOrReplaceTempView(\"mostPopularItemInABasket\")\n","user":"anonymous","dateUpdated":"2018-12-20T11:09:52+0000","config":{"tableHide":false,"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"mostPopularItemInABasket: org.apache.spark.sql.DataFrame = [items: array<double>, freq: bigint]\n"}]},"apps":[],"jobName":"paragraph_1545296867399_-1852081805","id":"20181130-061808_871802034","dateCreated":"2018-12-20T09:07:47+0000","dateStarted":"2018-12-20T11:10:00+0000","dateFinished":"2018-12-20T11:13:35+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:5701"},{"text":"%sql\r\nselect items, freq from mostPopularItemInABasket   order by freq desc limit 20","user":"anonymous","dateUpdated":"2018-12-21T01:42:23+0000","config":{"tableHide":false,"editorSetting":{"language":"sql","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/sql","fontSize":9,"results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"items":"string","freq":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false},"multiBarChart":{"rotate":{"degree":"-45"},"xLabelStatus":"default"},"lineChart":{"rotate":{"degree":"-45"},"xLabelStatus":"default"},"stackedAreaChart":{"rotate":{"degree":"-45"},"xLabelStatus":"default"}},"commonSetting":{},"keys":[{"name":"items","index":0,"aggr":"sum"}],"groups":[],"values":[{"name":"freq","index":1,"aggr":"sum"}]},"helium":{}}},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"ERROR","msg":[{"type":"TEXT","data":"java.lang.IllegalStateException: SparkContext has been shutdown\n\tat org.apache.spark.SparkContext.runJob(SparkContext.scala:2026)\n\tat org.apache.spark.SparkContext.runJob(SparkContext.scala:2131)\n\tat org.apache.spark.rdd.RDD$$anonfun$reduce$1.apply(RDD.scala:1035)\n\tat org.apache.spark.rdd.RDDOperationScope$.withScope(RDDOperationScope.scala:151)\n\tat org.apache.spark.rdd.RDDOperationScope$.withScope(RDDOperationScope.scala:112)\n\tat org.apache.spark.rdd.RDD.withScope(RDD.scala:363)\n\tat org.apache.spark.rdd.RDD.reduce(RDD.scala:1017)\n\tat org.apache.spark.rdd.RDD$$anonfun$takeOrdered$1.apply(RDD.scala:1439)\n\tat org.apache.spark.rdd.RDDOperationScope$.withScope(RDDOperationScope.scala:151)\n\tat org.apache.spark.rdd.RDDOperationScope$.withScope(RDDOperationScope.scala:112)\n\tat org.apache.spark.rdd.RDD.withScope(RDD.scala:363)\n\tat org.apache.spark.rdd.RDD.takeOrdered(RDD.scala:1426)\n\tat org.apache.spark.sql.execution.TakeOrderedAndProjectExec.executeCollect(limit.scala:135)\n\tat org.apache.spark.sql.Dataset.org$apache$spark$sql$Dataset$$collectFromPlan(Dataset.scala:3278)\n\tat org.apache.spark.sql.Dataset$$anonfun$head$1.apply(Dataset.scala:2489)\n\tat org.apache.spark.sql.Dataset$$anonfun$head$1.apply(Dataset.scala:2489)\n\tat org.apache.spark.sql.Dataset$$anonfun$52.apply(Dataset.scala:3259)\n\tat org.apache.spark.sql.execution.SQLExecution$.withNewExecutionId(SQLExecution.scala:77)\n\tat org.apache.spark.sql.Dataset.withAction(Dataset.scala:3258)\n\tat org.apache.spark.sql.Dataset.head(Dataset.scala:2489)\n\tat org.apache.spark.sql.Dataset.take(Dataset.scala:2703)\n\tat sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n\tat sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\n\tat sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\n\tat java.lang.reflect.Method.invoke(Method.java:498)\n\tat org.apache.zeppelin.spark.SparkZeppelinContext.showData(SparkZeppelinContext.java:108)\n\tat org.apache.zeppelin.spark.SparkSqlInterpreter.interpret(SparkSqlInterpreter.java:135)\n\tat org.apache.zeppelin.interpreter.LazyOpenInterpreter.interpret(LazyOpenInterpreter.java:103)\n\tat org.apache.zeppelin.interpreter.remote.RemoteInterpreterServer$InterpretJob.jobRun(RemoteInterpreterServer.java:633)\n\tat org.apache.zeppelin.scheduler.Job.run(Job.java:188)\n\tat org.apache.zeppelin.scheduler.FIFOScheduler$1.run(FIFOScheduler.java:140)\n\tat java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)\n\tat java.util.concurrent.FutureTask.run(FutureTask.java:266)\n\tat java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$201(ScheduledThreadPoolExecutor.java:180)\n\tat java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:293)\n\tat java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)\n\tat java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)\n\tat java.lang.Thread.run(Thread.java:748)\n"}]},"apps":[],"jobName":"paragraph_1545296867399_-1365039600","id":"20181130-062138_693156040","dateCreated":"2018-12-20T09:07:47+0000","dateStarted":"2018-12-21T01:42:23+0000","dateFinished":"2018-12-21T01:42:23+0000","status":"ERROR","progressUpdateIntervalMs":500,"$$hashKey":"object:5702"},{"text":"mostPopularItemInABasket.count()","user":"anonymous","dateUpdated":"2018-12-20T09:49:58+0000","config":{"tableHide":false,"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"res115: Long = 4123\n"}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://ip-172-31-35-197.ec2.internal:4040/jobs/job?id=1189"],"interpreterSettingId":"spark"}},"apps":[],"jobName":"paragraph_1545296867399_-750614243","id":"20181130-083808_486331998","dateCreated":"2018-12-20T09:07:47+0000","dateStarted":"2018-12-20T09:49:58+0000","dateFinished":"2018-12-20T09:50:05+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:5703"},{"text":"val ifThen = model_fpgrowth.associationRules\nifThen.createOrReplaceTempView(\"ifThen\")\n","user":"anonymous","dateUpdated":"2018-12-20T09:50:29+0000","config":{"tableHide":false,"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"ifThen: org.apache.spark.sql.DataFrame = [antecedent: array<string>, consequent: array<string> ... 1 more field]\n"}]},"apps":[],"jobName":"paragraph_1545296867399_1517020006","id":"20181130-082938_1045740327","dateCreated":"2018-12-20T09:07:47+0000","dateStarted":"2018-12-20T09:50:29+0000","dateFinished":"2018-12-20T09:50:33+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:5704"},{"text":"%sql\nselect antecedent as `antecedent (if)`, consequent as `consequent (then)`, confidence from ifThen where size(antecedent) < 2 and size(consequent) >2 order by confidence asc limit 20\n","user":"anonymous","dateUpdated":"2018-12-20T10:41:48+0000","config":{"tableHide":false,"editorSetting":{"language":"sql","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/sql","fontSize":9,"results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"antecedent (if)":"string","consequent (then)":"string","confidence":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{}},"helium":{}}},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"antecedent (if)\tconsequent (then)\tconfidence\n"}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://ip-172-31-35-197.ec2.internal:4040/jobs/job?id=1190"],"interpreterSettingId":"spark"}},"apps":[],"jobName":"paragraph_1545296867400_1777013840","id":"20181130-082937_1508980460","dateCreated":"2018-12-20T09:07:47+0000","dateStarted":"2018-12-20T09:50:46+0000","dateFinished":"2018-12-20T09:50:53+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:5705"},{"text":"ifThen.write.\n    option(\"header\", \"true\").\n    save(\"s3://find-smart-input/arule.csv\")","user":"anonymous","dateUpdated":"2018-12-20T09:07:47+0000","config":{"tableHide":false,"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"ERROR","msg":[{"type":"TEXT","data":"org.apache.spark.sql.AnalysisException: path s3://find-smart-input/arule.csv already exists.;\n  at org.apache.spark.sql.execution.datasources.InsertIntoHadoopFsRelationCommand.run(InsertIntoHadoopFsRelationCommand.scala:109)\n  at org.apache.spark.sql.execution.command.DataWritingCommandExec.sideEffectResult$lzycompute(commands.scala:104)\n  at org.apache.spark.sql.execution.command.DataWritingCommandExec.sideEffectResult(commands.scala:102)\n  at org.apache.spark.sql.execution.command.DataWritingCommandExec.doExecute(commands.scala:122)\n  at org.apache.spark.sql.execution.SparkPlan$$anonfun$execute$1.apply(SparkPlan.scala:131)\n  at org.apache.spark.sql.execution.SparkPlan$$anonfun$execute$1.apply(SparkPlan.scala:127)\n  at org.apache.spark.sql.execution.SparkPlan$$anonfun$executeQuery$1.apply(SparkPlan.scala:155)\n  at org.apache.spark.rdd.RDDOperationScope$.withScope(RDDOperationScope.scala:151)\n  at org.apache.spark.sql.execution.SparkPlan.executeQuery(SparkPlan.scala:152)\n  at org.apache.spark.sql.execution.SparkPlan.execute(SparkPlan.scala:127)\n  at org.apache.spark.sql.execution.QueryExecution.toRdd$lzycompute(QueryExecution.scala:80)\n  at org.apache.spark.sql.execution.QueryExecution.toRdd(QueryExecution.scala:80)\n  at org.apache.spark.sql.DataFrameWriter$$anonfun$runCommand$1.apply(DataFrameWriter.scala:656)\n  at org.apache.spark.sql.DataFrameWriter$$anonfun$runCommand$1.apply(DataFrameWriter.scala:656)\n  at org.apache.spark.sql.execution.SQLExecution$.withNewExecutionId(SQLExecution.scala:77)\n  at org.apache.spark.sql.DataFrameWriter.runCommand(DataFrameWriter.scala:656)\n  at org.apache.spark.sql.DataFrameWriter.saveToV1Source(DataFrameWriter.scala:273)\n  at org.apache.spark.sql.DataFrameWriter.save(DataFrameWriter.scala:267)\n  at org.apache.spark.sql.DataFrameWriter.save(DataFrameWriter.scala:225)\n  ... 76 elided\n"}]},"apps":[],"jobName":"paragraph_1545296867400_-1025477016","id":"20181130-085850_1540763718","dateCreated":"2018-12-20T09:07:47+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:5706"},{"text":"spark.sql(\"select * from parquet.`s3://find-smart-input/arule.csv` where confidence > 0.8\").show()","user":"anonymous","dateUpdated":"2018-12-20T09:07:47+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+--------------------+------------+------------------+\n|          antecedent|  consequent|        confidence|\n+--------------------+------------+------------------+\n|           [39Y7916]|   [43W9049]|0.8181818181818182|\n|[7Y37A01093, 4L67...|[7N67A00883]|0.8367346938775511|\n|[0C52861, 0A36536...|   [0C52862]|0.9761904761904762|\n|[0B47045, 4X40E77...|[40AC0135UK]|               1.0|\n|[0B47045, 4X40E77...|[4X40E77328]|               1.0|\n|[0B47045, 0C52862...|[4XA0E97775]|0.8260869565217391|\n|[0B47045, 0C52862...|   [0C52861]|0.8695652173913043|\n|[4L47A09133, 7N67...|[4L47A09132]|0.9473684210526315|\n|[0B47045, 4X40E77...|[4X40E77322]|               1.0|\n|[0B47045, 4X40E77...|[40AC0135UK]|0.9714285714285714|\n|[0B47045, 4X40E77...|[4X40E77323]|               1.0|\n|[40A10065UK, 40AC...|[4X40E77328]|0.8448275862068966|\n|[4X40E77322, 40AC...|[4X40E77323]|0.9487179487179487|\n|[4X40E77322, 40AC...|[4X40E77324]|0.8974358974358975|\n|[4X40E77322, 40AC...|   [0B47045]|0.8717948717948718|\n|[4X40E77322, 4X30...|[4X40E77323]|0.8717948717948718|\n|[4X40E77322, 4X30...|   [06P4069]|0.8717948717948718|\n|[4X40E77322, 4X30...|[40A90090UK]|0.9743589743589743|\n|[4X40E77322, 4X30...|[4X40E77328]|0.9743589743589743|\n|[0B47045, 40AC013...|[4X40E77322]|               1.0|\n+--------------------+------------+------------------+\nonly showing top 20 rows\n\n"}]},"apps":[],"jobName":"paragraph_1545296867400_2003082640","id":"20181130-094113_938834290","dateCreated":"2018-12-20T09:07:47+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:5707"},{"user":"anonymous","dateUpdated":"2018-12-20T09:07:47+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1545296867400_958119655","id":"20181130-094530_571852026","dateCreated":"2018-12-20T09:07:47+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:5708"}],"name":"FPGrowth_Arule","id":"2DZKMQZUY","noteParams":{},"noteForms":{},"angularObjects":{"spark:shared_process":[]},"config":{"isZeppelinNotebookCronEnable":false,"looknfeel":"default","personalizedMode":"false"},"info":{}}