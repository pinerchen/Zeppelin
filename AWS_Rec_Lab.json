{"paragraphs":[{"text":"//**********************************************************//\n//                 Welcome to Lab 2                         //\n//**********************************************************//\n","user":"anonymous","dateUpdated":"2019-03-01T12:50:31+0000","config":{"tableHide":true,"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1551442563154_-920736558","id":"20190223-071018_1527146340","dateCreated":"2019-03-01T12:16:03+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:15768"},{"text":"//載入涵式庫\n\nimport java.io.File\nimport scala.io.Source\nimport org.apache.log4j.Logger\nimport org.apache.log4j.Level\n\nimport org.apache.spark.ml.evaluation\nimport org.apache.spark.ml.fpm.FPGrowth\nimport org.apache.spark.ml.feature.StringIndexer\nimport org.apache.spark.ml.feature.VectorAssembler\nimport org.apache.spark.broadcast.Broadcast\nimport org.apache.spark.ml.evaluation.RegressionEvaluator\n\nimport org.apache.spark.mllib.evaluation.RankingMetrics\nimport org.apache.spark.mllib.recommendation.Rating\nimport org.apache.spark.mllib.recommendation.ALS\nimport org.apache.spark.mllib.recommendation.MatrixFactorizationModel\n\nimport org.apache.spark.sql.functions._\nimport org.apache.spark.sql.functions.explode\nimport org.apache.spark.sql.{DataFrame, Dataset,SparkSession}\n\nimport org.apache.spark.sql.Row\nimport org.apache.spark.SparkConf\nimport org.apache.spark.SparkContext\nimport org.apache.spark.SparkContext._\nimport org.apache.spark.broadcast.Broadcast\nimport org.apache.spark.rdd.RDD\n\n\n","user":"anonymous","dateUpdated":"2019-03-01T12:50:31+0000","config":{"tableHide":true,"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"import java.io.File\nimport scala.io.Source\nimport org.apache.log4j.Logger\nimport org.apache.log4j.Level\nimport org.apache.spark.ml.evaluation\nimport org.apache.spark.ml.fpm.FPGrowth\nimport org.apache.spark.ml.feature.StringIndexer\nimport org.apache.spark.ml.feature.VectorAssembler\nimport org.apache.spark.broadcast.Broadcast\nimport org.apache.spark.ml.evaluation.RegressionEvaluator\nimport org.apache.spark.mllib.evaluation.RankingMetrics\nimport org.apache.spark.mllib.recommendation.Rating\nimport org.apache.spark.mllib.recommendation.ALS\nimport org.apache.spark.mllib.recommendation.MatrixFactorizationModel\nimport org.apache.spark.sql.functions._\nimport org.apache.spark.sql.functions.explode\nimport org.apache.spark.sql.{DataFrame, Dataset, SparkSession}\nimport org.apache.spark.sql.Row\nimport org.apache.spark.SparkConf\nimport org.apache.spark.SparkContext\nimport org.apache.spark.SparkContext._\nimport org.apache.spark.broadcast.Broadcast\nimport org.apache.spark.rdd.RDD\n"}]},"apps":[],"jobName":"paragraph_1551442563158_957630440","id":"20181227-090354_26808948","dateCreated":"2019-03-01T12:16:03+0000","dateStarted":"2019-03-01T12:16:14+0000","dateFinished":"2019-03-01T12:16:40+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:15769"},{"text":"// load CSV from S3 bucket\nval Lab2_loaddata = spark.read.option(\"header\",\"true\").csv(\"s3://lenovorecosys/rawdata/Quotation/Quotations-122718-ROW-DATA.csv\")\nLab2_loaddata.printSchema()\nLab2_loaddata.createOrReplaceTempView(\"Lab2_loaddata\")\n","user":"anonymous","dateUpdated":"2019-03-01T12:50:31+0000","config":{"tableHide":true,"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"Lab2_loaddata: org.apache.spark.sql.DataFrame = [Quotation: Quotation ID: string, Quotation: Created Date: string ... 15 more fields]\nroot\n |-- Quotation: Quotation ID: string (nullable = true)\n |-- Quotation: Created Date: string (nullable = true)\n |-- Quotation: Record Type: string (nullable = true)\n |-- Display Net Price Currency: string (nullable = true)\n |-- Display Net Price: string (nullable = true)\n |-- Display Quantity: string (nullable = true)\n |-- Contract Type: string (nullable = true)\n |-- Country: string (nullable = true)\n |-- Account ID: string (nullable = true)\n |-- Proposal Line Item: Line Item Id: string (nullable = true)\n |-- Product: Product Family: string (nullable = true)\n |-- PRODUCT ID: string (nullable = true)\n |-- ProductLPH: string (nullable = true)\n |-- PH1: string (nullable = true)\n |-- Description: string (nullable = true)\n |-- Product: Offering Type: string (nullable = true)\n |-- ID: string (nullable = true)\n\n"}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://ip-172-31-0-164.ec2.internal:4040/jobs/job?id=0"],"interpreterSettingId":"spark"}},"apps":[],"jobName":"paragraph_1551442563158_201313126","id":"20190114-100647_79736839","dateCreated":"2019-03-01T12:16:03+0000","dateStarted":"2019-03-01T12:23:13+0000","dateFinished":"2019-03-01T12:23:30+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:15770"},{"text":"%sql\nselect * from Lab2_loaddata limit 20","user":"anonymous","dateUpdated":"2019-03-01T12:50:31+0000","config":{"editorSetting":{"language":"sql","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/sql","fontSize":9,"results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"Quotation: Quotation ID":"string","Quotation: Created Date":"string","Quotation: Record Type":"string","Display Net Price Currency":"string","Display Net Price":"string","Display Quantity":"string","Contract Type":"string","Country":"string","Account ID":"string","Proposal Line Item: Line Item Id":"string","Product: Product Family":"string","PRODUCT ID":"string","ProductLPH":"string","PH1":"string","Description":"string","Product: Offering Type":"string","ID":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{}}}},"enabled":true,"tableHide":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"Quotation: Quotation ID\tQuotation: Created Date\tQuotation: Record Type\tDisplay Net Price Currency\tDisplay Net Price\tDisplay Quantity\tContract Type\tCountry\tAccount ID\tProposal Line Item: Line Item Id\tProduct: Product Family\tPRODUCT ID\tProductLPH\tPH1\tDescription\tProduct: Offering Type\tID\nQ-00007446\t17/01/2018\tCPQ\tEUR\t11267\t20\tQuantity\tIreland\t001d000000HisDM\tQL-0000455734\t10MAS1P800\tMTM1\t11TC1MD710T10MA10R\t1\t I56500 4G 1TB\tMTM\t1\nQ-00043303\t22/06/2018\tCPQ\tEUR\t69720\t105\tQuantity\tIreland\t001d000000HisDM\tQL-0003329127\t10MAS4JM00\tMTM1\t11TC1MD710T10MA10R\t1\t I56500 4G 1TB W10DG\tMTM\t1\nQ-00023615\t15/04/2018\tCPQ\tEUR\t39840\t60\tQuantity\tIreland\t001d000000HisDM\tQL-0001728698\t10MAS4JM00\tMTM1\t11TC1MD710T10MA10R\t1\t I56500 4G 1TB W10DG\tMTM\t1\nQ-00028519\t4/5/2018\tCPQ\tEUR\t14000\t1000\tQuantity\tFrance\t001b0000002npdD\tQL-0002178900\t4X90Q93976\tAccessory1\t430WNCBVC01\t4\t ThinkStation Mini DP to HDMI Adapter\tAccessory\t1\nQ-00033211\t23/05/2018\tCPQ\tEUR\t8305\t755\tQuantity\tSpain\t001b0000002npeT\tQL-0002578139\t4X90Q93976\tAccessory1\t430WNCBVC01\t4\t ThinkStation Mini DP to HDMI Adapter\tAccessory\t1\nQ-00039589\t12/6/2018\tCPQ\tUSD\t15\t1\tQuantity\tLebanon\t001b000000hc8Ef\tQL-0003124909\t4X90Q93976\tAccessory1\t430WNCBVC01\t4\t ThinkStation Mini DP to HDMI Adapter\tAccessory\t1\nQ-00040248\t14/06/2018\tCPQ\tEUR\t340\t20\tQuantity\tGreece\t001b000000wqfMp\tQL-0003153152\t4X90Q93976\tAccessory1\t430WNCBVC01\t4\t ThinkStation Mini DP to HDMI Adapter\tAccessory\t1\nQ-00051236\t13/07/2018\tCPQ\tEUR\t2900\t200\tQuantity\tItaly\t001b000000pQKcX\tQL-0004460287\t4X90Q93976\tAccessory1\t430WNCBVC01\t4\t ThinkStation Mini DP to HDMI Adapter\tAccessory\t1\nQ-00058591\t3/8/2018\tCPQ\tEUR\t4500\t300\tQuantity\tFrance\t0010X00004DviVw\tQL-0004512797\t4X90Q93976\tAccessory1\t430WNCBVC01\t4\t ThinkStation Mini DP to HDMI Adapter\tAccessory\t1\nQ-00051948\t16/07/2018\tCPQ\tUSD\t1300\t50\tQuantity\tPakistan\t001b000003otFfR\tQL-0004533513\t4X90Q93976\tAccessory1\t430WNCBVC01\t4\t ThinkStation Mini DP to HDMI Adapter\tAccessory\t1\nQ-00058472\t3/8/2018\tCPQ\tGBP\t1200\t100\tQuantity\tU.K.\t001d000000Hiufr\tQL-0004495111\t4X90Q93976\tAccessory1\t430WNCBVC01\t4\t ThinkStation Mini DP to HDMI Adapter\tAccessory\t1\nQ-00040898\t16/06/2018\tCPQ\tDKK\t78750\t50\tNon Quantity\tDenmark\t001b0000002nnpS\tQL-0003297269\t4XH0Q89603\tAccessory2\t430WNACRAH1\t4\t ThinkStation VROC Key Module by Intel -Premium\tAccessory\t2\nQ-00024192\t17/04/2018\tCPQ\tUSD\t2750\t50\tQuantity\tIsrael\t001b000000WlVmF\tQL-0001751172\t0A36236\tAccessory3\t40I00020001\t4\t?ThinkPad 170W AC adapter for W520/W530 - Switzerland\tAccessory\t3\nQ-00045816\t29/06/2018\tCPQ\tGBP\t7600\t200\tQuantity\tU.K.\t001d000000HiuZp\tQL-0003603436\t0A36235\tAccessory3\t40I00020001\t4\t?ThinkPad 170W AC adapter for W520/W530 - UK/SA/HK\tAccessory\t3\nQ-00017414\t19/03/2018\tCPQ\tGBP\t3579\t100\tQuantity\tU.K.\t001d000000Hiw9n\tQL-0001292631\t0A36235\tAccessory3\t40I00020001\t4\t?ThinkPad 170W AC adapter for W520/W530 - UK/SA/HK\tAccessory\t3\nQ-00050070\t10/7/2018\tCPQ\tGBP\t3579\t100\tQuantity\tU.K.\t001d000000Hiw9n\tQL-0003811904\t0A36235\tAccessory3\t40I00020001\t4\t?ThinkPad 170W AC adapter for W520/W530 - UK/SA/HK\tAccessory\t3\nQ-00019018\t26/03/2018\tCPQ\tGBP\t3579\t100\tQuantity\tU.K.\t001d000000Hiw9n\tQL-0001400054\t0A36235\tAccessory3\t40I00020001\t4\t?ThinkPad 170W AC adapter for W520/W530 - UK/SA/HK\tAccessory\t3\nQ-00035985\t1/6/2018\tCPQ\tUSD\t65\t5\tQuantity\tMorocco\t001b000000hc9lM\tQL-0002805019\tGX40Q53788\tAccessory4\tG10NNCASL01\tG\t14 Inch Laptop Sleeve\tAccessory\t4\nQ-00053254\t19/07/2018\tCPQ\tUSD\t5500\t500\tQuantity\tIsrael\t001b000000ofB0m\tQL-0004063508\tGX40Q53788\tAccessory4\tG10NNCASL01\tG\t14 Inch Laptop Sleeve\tAccessory\t4\nQ-00065588\t29/08/2018\tCPQ\tUSD\t5500\t500\tQuantity\tIsrael\t001b000000ofB0m\tQL-0005066326\tGX40Q53788\tAccessory4\tG10NNCASL01\tG\t14 Inch Laptop Sleeve\tAccessory\t4\n"}]},"apps":[],"jobName":"paragraph_1551442563158_1256163596","id":"20190301-094902_2111242153","dateCreated":"2019-03-01T12:16:03+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:15771"},{"text":"//使用不同幣別的國家在產品的消費分布\n// operation used: select, alias, cast\nval select_column_toDouble = Lab2_loaddata.\nselect($\"Display Net Price Currency\".alias(\"Currency\"),\n       $\"Display Net Price\".cast(\"int\").alias(\"Net_Price\"),\n       $\"Display Quantity\".cast(\"int\").alias(\"Quantity\"),\n       $\"PRODUCT ID\".alias(\"Product_ID\"))\nselect_column_toDouble.printSchema()\nselect_column_toDouble.createOrReplaceTempView(\"select_column_toDouble\")","user":"anonymous","dateUpdated":"2019-03-01T12:50:31+0000","config":{"tableHide":true,"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"select_column_toDouble: org.apache.spark.sql.DataFrame = [Currency: string, Net_Price: int ... 2 more fields]\nroot\n |-- Currency: string (nullable = true)\n |-- Net_Price: integer (nullable = true)\n |-- Quantity: integer (nullable = true)\n |-- Product_ID: string (nullable = true)\n\n"}]},"apps":[],"jobName":"paragraph_1551442563159_1484435159","id":"20190122-063925_1153790133","dateCreated":"2019-03-01T12:16:03+0000","dateStarted":"2019-03-01T12:25:18+0000","dateFinished":"2019-03-01T12:25:19+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:15772"},{"text":"%sql\nselect * from select_column_toDouble \n","user":"anonymous","dateUpdated":"2019-03-01T12:50:31+0000","config":{"tableHide":true,"editorSetting":{"language":"sql","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/sql","fontSize":9,"results":{"0":{"graph":{"mode":"stackedAreaChart","height":413.252,"optionOpen":false,"setting":{"table":{"tableGridState":{"columns":[{"name":"country","visible":true,"width":"*","sort":{"priority":0,"direction":"desc"},"filters":[{}],"pinned":""},{"name":"count(ID)","visible":true,"width":"*","sort":{},"filters":[{}],"pinned":""}],"scrollFocus":{},"selection":[],"grouping":{"grouping":[],"aggregations":[],"rowExpandedStates":{}},"treeView":{},"pagination":{"paginationCurrentPage":1,"paginationPageSize":250}},"tableColumnTypeState":{"names":{"Currency":"string","Net_Price":"string","Quantity":"string","Product_ID":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false},"multiBarChart":{"rotate":{"degree":"-45"},"xLabelStatus":"default"},"stackedAreaChart":{"rotate":{"degree":"-45"},"xLabelStatus":"default","style":"stack"},"lineChart":{"rotate":{"degree":"-45"},"xLabelStatus":"default"},"pieChart":{},"scatterChart":{"xAxis":{"name":"Currency","index":0,"aggr":"sum"},"size":{"name":"Quantity","index":2,"aggr":"sum"}}},"keys":[{"name":"Currency","index":0,"aggr":"sum"}],"groups":[{"name":"Product_ID","index":3,"aggr":"sum"}],"values":[{"name":"Net_Price","index":1,"aggr":"max"}],"commonSetting":{}},"helium":{}}},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"Currency\tNet_Price\tQuantity\tProduct_ID\nEUR\t11267\t20\tMTM1\nEUR\t69720\t105\tMTM1\nEUR\t39840\t60\tMTM1\nEUR\t14000\t1000\tAccessory1\nEUR\t8305\t755\tAccessory1\nUSD\t15\t1\tAccessory1\nEUR\t340\t20\tAccessory1\nEUR\t2900\t200\tAccessory1\nEUR\t4500\t300\tAccessory1\nUSD\t1300\t50\tAccessory1\nGBP\t1200\t100\tAccessory1\nDKK\t78750\t50\tAccessory2\nUSD\t2750\t50\tAccessory3\nGBP\t7600\t200\tAccessory3\nGBP\t3579\t100\tAccessory3\nGBP\t3579\t100\tAccessory3\nGBP\t3579\t100\tAccessory3\nUSD\t65\t5\tAccessory4\nUSD\t5500\t500\tAccessory4\nUSD\t5500\t500\tAccessory4\nUSD\t5500\t500\tAccessory4\nEUR\t900\t100\tAccessory4\nGBP\t8875\t1250\tAccessory4\nEUR\t8966\t50\tAccessory5\nEUR\t268980\t1500\tAccessory5\nGBP\t8120\t40\tAccessory6\nGBP\t8120\t40\tAccessory6\nEUR\t221\t1\tAccessory6\nEUR\t6090\t30\tAccessory6\nUSD\t12500\t50\tAccessory6\nUSD\t8400\t30\tAccessory6\nGBP\t16900\t100\tAccessory6\nGBP\t16900\t100\tAccessory6\nGBP\t16900\t100\tAccessory6\nGBP\t19100\t100\tAccessory6\nGBP\t19100\t100\tAccessory6\nGBP\t9350\t50\tAccessory6\nEUR\t8500\t50\tAccessory7\nGBP\t17000\t100\tAccessory7\nGBP\t17000\t100\tAccessory7\nEUR\t8350\t50\tAccessory7\nEUR\t11520\t72\tAccessory7\nEUR\t8500\t50\tAccessory7\nEUR\t15000\t100\tAccessory7\nUSD\t10500\t50\tAccessory7\nDKK\t1100\t1\tAccessory7\nEUR\t2925\t15\tAccessory7\nEUR\t9500\t50\tAccessory7\nEUR\t9960\t60\tAccessory7\nEUR\t9960\t60\tAccessory7\nEUR\t15900\t100\tAccessory7\nEUR\t10080\t60\tAccessory7\nEUR\t9500\t50\tAccessory7\nEUR\t38000\t200\tAccessory7\nUSD\t2200\t10\tAccessory7\nEUR\t72500\t500\tAccessory7\nEUR\t72500\t500\tAccessory7\nEUR\t18000\t100\tAccessory7\nEUR\t4914\t30\tAccessory7\nEUR\t4500\t25\tAccessory7\nEUR\t6435\t33\tAccessory7\nEUR\t70000\t500\tAccessory7\nEUR\t17200\t100\tAccessory7\nEUR\t4914\t30\tAccessory7\nUSD\t5425\t25\tAccessory7\nEUR\t995\t5\tAccessory7\nEUR\t16000\t100\tAccessory7\nEUR\t1920\t10\tAccessory7\nUSD\t101500\t500\tAccessory7\nEUR\t17000\t100\tAccessory7\nEUR\t16500\t100\tAccessory7\nEUR\t18000\t100\tAccessory7\nUSD\t1900\t10\tAccessory7\nEUR\t9000\t50\tAccessory7\nEUR\t2925\t15\tAccessory7\nEUR\t31200\t200\tAccessory7\nEUR\t22400\t100\tAccessory7\nEUR\t31600\t200\tAccessory7\nEUR\t30000\t200\tAccessory7\nEUR\t30000\t200\tAccessory7\nEUR\t18000\t100\tAccessory7\nDKK\t36400\t25\tAccessory7\nEUR\t15000\t100\tAccessory7\nEUR\t15000\t100\tAccessory7\nUSD\t404000\t2000\tAccessory7\nEUR\t10000\t50\tAccessory7\nUSD\t11693\t50\tAccessory7\nEUR\t3920\t20\tAccessory7\nEUR\t1890\t10\tAccessory7\nEUR\t1890\t10\tAccessory7\nEUR\t18900\t100\tAccessory7\nEUR\t1890\t10\tAccessory7\nEUR\t9450\t50\tAccessory7\nEUR\t19500\t100\tAccessory7\nEUR\t9450\t50\tAccessory7\nEUR\t9750\t50\tAccessory7\nEUR\t19500\t100\tAccessory7\nEUR\t4250\t25\tAccessory7\nEUR\t1700\t10\tAccessory7\nSEK\t80000\t50\tAccessory7\nEUR\t17000\t100\tAccessory7\nSEK\t378420\t200\tAccessory7\nEUR\t4920\t30\tAccessory7\nEUR\t4920\t30\tAccessory7\nEUR\t4920\t30\tAccessory7\nEUR\t4920\t30\tAccessory7\nSEK\t1680000\t1000\tAccessory7\nUSD\t20200\t100\tAccessory7\nEUR\t34800\t200\tAccessory7\nEUR\t35800\t200\tAccessory7\nEUR\t35800\t200\tAccessory7\nEUR\t8700\t50\tAccessory7\nEUR\t8700\t50\tAccessory7\nEUR\t35800\t200\tAccessory7\nEUR\t35800\t200\tAccessory7\nEUR\t19500\t100\tAccessory7\nEUR\t74500\t500\tAccessory7\nEUR\t4350\t30\tAccessory7\nEUR\t3215\t20\tAccessory7\nEUR\t18000\t100\tAccessory7\nEUR\t1447\t9\tAccessory7\nEUR\t18000\t100\tAccessory7\nEUR\t34800\t200\tAccessory7\nDKK\t121500\t100\tAccessory7\nDKK\t125200\t100\tAccessory7\nDKK\t125200\t100\tAccessory7\nDKK\t139400\t100\tAccessory7\nDKK\t135300\t100\tAccessory7\nEUR\t7965\t45\tAccessory7\nEUR\t3215\t20\tAccessory7\nEUR\t8850\t50\tAccessory7\nEUR\t3215\t20\tAccessory7\nEUR\t9100\t50\tAccessory7\nUSD\t40000\t200\tAccessory7\nEUR\t195\t1\tAccessory7\nEUR\t18500\t100\tAccessory7\nUSD\t9300\t50\tAccessory7\nEUR\t273000\t1500\tAccessory7\nUSD\t18600\t100\tAccessory7\nEUR\t8750\t50\tAccessory7\nEUR\t8000\t50\tAccessory7\nEUR\t910\t5\tAccessory7\nEUR\t15800\t100\tAccessory7\nEUR\t5100\t30\tAccessory7\nUSD\t10200\t50\tAccessory7\nEUR\t165\t1\tAccessory7\nEUR\t3840\t20\tAccessory7\nDKK\t7285\t5\tAccessory7\nEUR\t1735\t10\tAccessory7\nEUR\t3930\t30\tAccessory7\nEUR\t3930\t30\tAccessory7\nEUR\t25050\t150\tAccessory7\nEUR\t1890\t10\tAccessory7\nEUR\t5100\t30\tAccessory7\nUSD\t10650\t50\tAccessory7\nEUR\t4800\t30\tAccessory7\nEUR\t43250\t250\tAccessory7\nEUR\t3100\t20\tAccessory7\nEUR\t5100\t30\tAccessory7\nEUR\t33800\t200\tAccessory7\nEUR\t33800\t200\tAccessory7\nUSD\t9750\t50\tAccessory7\nEUR\t18900\t100\tAccessory7\nUSD\t8200\t40\tAccessory7\nEUR\t19900\t100\tAccessory7\nEUR\t19900\t100\tAccessory7\nEUR\t19900\t100\tAccessory7\nEUR\t11520\t72\tAccessory7\nEUR\t1950\t10\tAccessory7\nEUR\t1800\t10\tAccessory7\nEUR\t13650\t75\tAccessory7\nEUR\t17800\t100\tAccessory7\nEUR\t1730\t10\tAccessory7\nEUR\t21600\t100\tAccessory7\nEUR\t21600\t100\tAccessory7\nEUR\t21600\t100\tAccessory7\nEUR\t21600\t100\tAccessory7\nEUR\t195\t1\tAccessory7\nEUR\t171\t1\tAccessory7\nEUR\t176\t1\tAccessory7\nEUR\t5670\t30\tAccessory7\nEUR\t5670\t30\tAccessory7\nEUR\t176\t1\tAccessory7\nEUR\t71440\t380\tAccessory7\nEUR\t5850\t30\tAccessory7\nEUR\t2180\t15\tAccessory7\nUSD\t19500\t100\tAccessory7\nUSD\t195\t1\tAccessory7\nEUR\t1890\t10\tAccessory7\nEUR\t1700\t10\tAccessory7\nEUR\t170\t1\tAccessory7\nEUR\t340\t2\tAccessory7\nEUR\t5490\t30\tAccessory7\nUSD\t17000\t100\tAccessory7\nEUR\t1800\t10\tAccessory7\nEUR\t1950\t10\tAccessory7\nUSD\t2000\t10\tAccessory7\nUSD\t206\t1\tAccessory7\nUSD\t980\t5\tAccessory7\nEUR\t195\t1\tAccessory7\nEUR\t1950\t10\tAccessory7\nGBP\t7200\t50\tAccessory7\nEUR\t950\t5\tAccessory7\nEUR\t950\t5\tAccessory7\nGBP\t7200\t50\tAccessory7\nGBP\t7200\t50\tAccessory7\nEUR\t2640\t20\tAccessory7\nEUR\t180\t1\tAccessory7\nEUR\t3800\t20\tAccessory7\nEUR\t585\t3\tAccessory7\nEUR\t15500\t100\tAccessory7\nEUR\t15500\t100\tAccessory7\nEUR\t15500\t100\tAccessory7\nEUR\t16800\t100\tAccessory7\nEUR\t11250\t50\tAccessory7\nEUR\t2960\t20\tAccessory7\nGBP\t15000\t100\tAccessory7\nEUR\t9750\t50\tAccessory7\nGBP\t102\t1\tAccessory7\nEUR\t5040\t30\tAccessory7\nEUR\t5040\t30\tAccessory7\nGBP\t13000\t100\tAccessory7\nEUR\t9150\t50\tAccessory7\nEUR\t10000\t50\tAccessory7\nEUR\t10000\t50\tAccessory7\nEUR\t10000\t50\tAccessory7\nGBP\t17200\t100\tAccessory7\nUSD\t9750\t50\tAccessory7\nUSD\t40800\t200\tAccessory7\nUSD\t40800\t200\tAccessory7\nUSD\t10200\t50\tAccessory7\nUSD\t10200\t50\tAccessory7\nUSD\t10200\t50\tAccessory7\nUSD\t10200\t50\tAccessory7\nGBP\t32500\t250\tAccessory7\nEUR\t18500\t100\tAccessory7\nGBP\t13100\t100\tAccessory7\nEUR\t680\t4\tAccessory7\nEUR\t672\t4\tAccessory7\nEUR\t7200\t40\tAccessory7\nEUR\t1800\t10\tAccessory7\nEUR\t7400\t40\tAccessory7\nEUR\t7400\t40\tAccessory7\nEUR\t21000\t100\tAccessory7\nEUR\t21000\t100\tAccessory7\nEUR\t10680\t60\tAccessory7\nUSD\t108500\t500\tAccessory7\nUSD\t108500\t500\tAccessory7\nUSD\t108500\t500\tAccessory7\nUSD\t108500\t500\tAccessory7\nGBP\t8700\t50\tAccessory7\nGBP\t26100\t150\tAccessory7\nEUR\t8750\t50\tAccessory7\nEUR\t8750\t50\tAccessory7\nEUR\t9350\t50\tAccessory7\nEUR\t8350\t50\tAccessory7\nEUR\t8350\t50\tAccessory7\nGBP\t29000\t200\tAccessory7\nEUR\t860\t5\tAccessory7\nGBP\t810\t6\tAccessory7\nGBP\t456\t3\tAccessory7\nGBP\t3420\t20\tAccessory7\nGBP\t31000\t200\tAccessory7\nGBP\t7134\t50\tAccessory7\nGBP\t7134\t50\tAccessory7\nGBP\t3525\t25\tAccessory7\nGBP\t31000\t200\tAccessory7\nGBP\t31000\t200\tAccessory7\nGBP\t31000\t200\tAccessory7\nGBP\t31000\t200\tAccessory7\nGBP\t31000\t200\tAccessory7\nGBP\t31000\t200\tAccessory7\nGBP\t7800\t50\tAccessory7\nGBP\t7800\t50\tAccessory7\nGBP\t7800\t50\tAccessory7\nGBP\t4125\t25\tAccessory7\nGBP\t15700\t100\tAccessory7\nGBP\t15700\t100\tAccessory7\nGBP\t1500\t10\tAccessory7\nGBP\t1500\t10\tAccessory7\nGBP\t3480\t20\tAccessory7\nGBP\t174\t1\tAccessory7\nGBP\t174\t1\tAccessory7\nDKK\t46050\t30\tAccessory8\nDKK\t46050\t30\tAccessory8\nUSD\t7770\t30\tAccessory8\nUSD\t8100\t30\tAccessory8\nEUR\t2640\t12\tAccessory8\nUSD\t8100\t30\tAccessory8\nGBP\t47250\t250\tAccessory8\nGBP\t8120\t40\tAccessory8\nGBP\t8120\t40\tAccessory8\nEUR\t10950\t50\tAccessory8\nEUR\t10950\t50\tAccessory8\nEUR\t6060\t30\tAccessory8\nEUR\t482\t2\tAccessory8\nEUR\t2400\t10\tAccessory8\nEUR\t4600\t20\tAccessory8\nEUR\t9000\t40\tAccessory8\nEUR\t9000\t40\tAccessory8\nEUR\t21500\t100\tAccessory8\nEUR\t21500\t100\tAccessory8\nEUR\t21500\t100\tAccessory8\nEUR\t72000\t300\tAccessory8\nEUR\t11700\t60\tAccessory8\nEUR\t11700\t60\tAccessory8\nEUR\t11700\t60\tAccessory8\nEUR\t11700\t60\tAccessory8\nEUR\t7050\t30\tAccessory8\nEUR\t6780\t30\tAccessory8\nUSD\t8100\t30\tAccessory8\nUSD\t8100\t30\tAccessory8\nEUR\t19800\t100\tAccessory8\nEUR\t5000\t20\tAccessory8\nDKK\t46050\t30\tAccessory8\nDKK\t47430\t30\tAccessory8\nEUR\t768\t4\tAccessory8\nEUR\t1100\t5\tAccessory8\nEUR\t10900\t50\tAccessory8\nGBP\t609\t3\tAccessory8\nGBP\t8750\t50\tAccessory8\nGBP\t37200\t200\tAccessory8\nGBP\t37200\t200\tAccessory8\nGBP\t37200\t200\tAccessory8\nEUR\t5400\t30\tAccessory9\nEUR\t5400\t30\tAccessory9\nDKK\t350000\t200\tAccessory9\nDKK\t38900\t25\tAccessory9\nEUR\t9000\t50\tAccessory9\nEUR\t10000\t50\tAccessory9\nUSD\t11693\t50\tAccessory9\nEUR\t3700\t20\tAccessory9\nNOK\t18950\t10\tAccessory9\nNOK\t18910\t10\tAccessory9\nSEK\t41000\t20\tAccessory9\nDKK\t290000\t200\tAccessory9\nEUR\t1710\t9\tAccessory9\nEUR\t9500\t50\tAccessory9\nEUR\t5700\t30\tAccessory9\nNOK\t56730\t30\tAccessory9\nEUR\t23040\t120\tAccessory9\nEUR\t190\t1\tAccessory9\nUSD\t22500\t100\tAccessory9\nDKK\t1480\t1\tAccessory9\nUSD\t8120\t40\tAccessory9\nEUR\t5100\t30\tAccessory9\nUSD\t22500\t100\tAccessory9\nDKK\t300000\t200\tAccessory9\nDKK\t305000\t200\tAccessory9\nDKK\t300000\t200\tAccessory9\nEUR\t10000\t50\tAccessory9\nDKK\t37000\t20\tAccessory9\nDKK\t18500\t10\tAccessory9\nEUR\t213\t1\tAccessory10\nEUR\t8500\t50\tAccessory11\nUSD\t10000\t50\tAccessory11\nEUR\t4788\t30\tAccessory11\nEUR\t4788\t30\tAccessory11\nEUR\t47400\t300\tAccessory11\nDKK\t57000\t40\tAccessory11\nEUR\t34200\t200\tAccessory11\nEUR\t3900\t20\tAccessory11\nDKK\t330000\t200\tAccessory11\nEUR\t8500\t50\tAccessory11\nEUR\t8500\t50\tAccessory11\nEUR\t3700\t20\tAccessory11\nEUR\t1700\t10\tAccessory11\nEUR\t32800\t200\tAccessory11\nEUR\t28400\t200\tAccessory11\nEUR\t4260\t30\tAccessory11\nDKK\t240000\t200\tAccessory11\nUSD\t200\t1\tAccessory11\nEUR\t9100\t50\tAccessory11\nEUR\t273000\t1500\tAccessory11\nUSD\t18600\t100\tAccessory11\nEUR\t8750\t50\tAccessory11\nUSD\t16095\t87\tAccessory11\nEUR\t1310\t10\tAccessory11\nEUR\t1310\t10\tAccessory11\nEUR\t8750\t50\tAccessory11\nEUR\t8750\t50\tAccessory11\nDKK\t290000\t200\tAccessory11\nDKK\t284000\t200\tAccessory11\nDKK\t290000\t200\tAccessory11\nEUR\t1720\t10\tAccessory11\nEUR\t8000\t50\tAccessory11\nEUR\t8000\t50\tAccessory11\nEUR\t8000\t50\tAccessory11\nUSD\t24600\t150\tAccessory11\nEUR\t920\t5\tAccessory11\nUSD\t19500\t100\tAccessory11\nUSD\t7800\t40\tAccessory11\nEUR\t570\t3\tAccessory11\nEUR\t2475\t15\tAccessory11\nEUR\t9000\t50\tAccessory11\nEUR\t9000\t50\tAccessory11\nEUR\t62000\t500\tAccessory11\nEUR\t9000\t50\tAccessory11\nEUR\t62000\t500\tAccessory11\nEUR\t62000\t500\tAccessory11\nEUR\t62000\t500\tAccessory11\nUSD\t41800\t200\tAccessory11\nUSD\t10450\t50\tAccessory11\nUSD\t10450\t50\tAccessory11\nUSD\t56400\t240\tAccessory11\nEUR\t7200\t40\tAccessory11\nUSD\t56400\t240\tAccessory11\nEUR\t8400\t50\tAccessory11\nUSD\t106000\t500\tAccessory11\nUSD\t106000\t500\tAccessory11\nGBP\t15100\t100\tAccessory11\nGBP\t15100\t100\tAccessory11\nGBP\t7750\t50\tAccessory11\nEUR\t31884\t150\tAccessory11\nGBP\t3750\t25\tAccessory11\nEUR\t646440\t3000\tAccessory11\nEUR\t31884\t150\tAccessory11\nGBP\t1560\t10\tAccessory11\nEUR\t124000\t1000\tAccessory11\nGBP\t918\t6\tAccessory11\nEUR\t124000\t1000\tAccessory11\nGBP\t1020\t6\tAccessory11\nEUR\t124000\t1000\tAccessory11\nEUR\t124000\t1000\tAccessory11\nEUR\t124000\t1000\tAccessory11\nEUR\t124000\t1000\tAccessory11\nEUR\t124000\t1000\tAccessory11\nEUR\t124000\t1000\tAccessory11\nEUR\t8300\t50\tAccessory11\nGBP\t30200\t200\tAccessory11\nGBP\t30200\t200\tAccessory11\nGBP\t30200\t200\tAccessory11\nGBP\t1570\t10\tAccessory11\nUSD\t125000\t1000\tAccessory12\nUSD\t7700\t110\tAccessory12\nUSD\t3626\t49\tAccessory12\nUSD\t2050\t25\tAccessory12\nUSD\t40400\t505\tAccessory12\nUSD\t21600\t300\tAccessory12\nUSD\t2190\t30\tAccessory12\nUSD\t7200\t100\tAccessory12\nUSD\t50400\t700\tAccessory12\nUSD\t14400\t200\tAccessory12\nUSD\t29200\t400\tAccessory12\nUSD\t27302\t374\tAccessory12\nUSD\t11700\t130\tAccessory12\nUSD\t6400\t50\tAccessory12\nUSD\t381\t3\tAccessory12\nUSD\t29200\t400\tAccessory12\nUSD\t730\t10\tAccessory12\nUSD\t2555\t35\tAccessory12\nUSD\t36000\t500\tAccessory12\nUSD\t14800\t200\tAccessory12\nUSD\t45100\t550\tAccessory12\nUSD\t28800\t400\tAccessory12\nUSD\t14000\t200\tAccessory12\nUSD\t6120\t85\tAccessory12\nUSD\t8200\t100\tAccessory12\nUSD\t15800\t200\tAccessory12\nUSD\t348462\t5400\tAccessory12\nUSD\t16600\t200\tAccessory12\nUSD\t33000\t500\tAccessory12\nUSD\t97200\t1200\tAccessory12\nUSD\t34320\t520\tAccessory12\nUSD\t72000\t1000\tAccessory12\nUSD\t68000\t1000\tAccessory12\nUSD\t106500\t1500\tAccessory12\nUSD\t66\t1\tAccessory12\nUSD\t19998\t303\tAccessory12\nUSD\t28800\t400\tAccessory12\nUSD\t21600\t300\tAccessory12\nUSD\t40200\t600\tAccessory12\nUSD\t82\t1\tAccessory12\nUSD\t21600\t300\tAccessory12\nUSD\t410\t5\tAccessory12\nUSD\t45000\t600\tAccessory12\nUSD\t1110\t15\tAccessory12\nUSD\t14400\t200\tAccessory12\nUSD\t14400\t200\tAccessory12\nUSD\t13680\t190\tAccessory12\nUSD\t1460\t20\tAccessory12\nUSD\t20746\t253\tAccessory12\nUSD\t42900\t550\tAccessory12\nUSD\t2920\t40\tAccessory12\nUSD\t75000\t1000\tAccessory12\nUSD\t730\t10\tAccessory12\nUSD\t2190\t30\tAccessory12\nUSD\t1825\t25\tAccessory12\nUSD\t6528\t51\tAccessory12\nUSD\t16800\t200\tAccessory12\nUSD\t37500\t300\tAccessory12\nUSD\t2920\t40\tAccessory12\nUSD\t127\t1\tAccessory12\nUSD\t8625\t69\tAccessory12\nUSD\t62906\t886\tAccessory12\nUSD\t48000\t600\tAccessory12\nUSD\t146000\t2000\tAccessory12\nUSD\t72000\t1000\tAccessory12\nUSD\t78650\t650\tAccessory12\nUSD\t16800\t240\tAccessory12\nUSD\t30960\t240\tAccessory12\nUSD\t16800\t240\tAccessory12\nUSD\t1460\t20\tAccessory12\nUSD\t37000\t500\tAccessory12\nUSD\t17750\t250\tAccessory12\nUSD\t29200\t400\tAccessory12\nUSD\t2840\t40\tAccessory12\nUSD\t84612\t1282\tAccessory12\nUSD\t1840\t23\tAccessory12\nUSD\t32800\t400\tAccessory12\nUSD\t14600\t200\tAccessory12\nUSD\t7200\t100\tAccessory12\nUSD\t17500\t250\tAccessory12\nEUR\t350\t50\tAccessory13\nEUR\t1000\t100\tAccessory13\nEUR\t10500\t1500\tAccessory13\nEUR\t1188\t99\tAccessory13\nEUR\t1188\t99\tAccessory13\nEUR\t300\t50\tAccessory14\nEUR\t9000\t1500\tAccessory14\nEUR\t350\t50\tAccessory15\nEUR\t10500\t1500\tAccessory15\nUSD\t12000\t1500\tAccessory16\nUSD\t500\t50\tAccessory16\nUSD\t340\t34\tAccessory16\nDKK\t56600\t20\tAccessory17\nDKK\t56600\t20\tAccessory17\nUSD\t14640\t30\tAccessory17\nUSD\t15300\t30\tAccessory17\nUSD\t15300\t30\tAccessory17\nEUR\t11310\t30\tAccessory17\nEUR\t900\t2\tAccessory17\nEUR\t8600\t20\tAccessory17\nUSD\t4600\t10\tAccessory17\nEUR\t111000\t300\tAccessory17\nEUR\t13500\t30\tAccessory17\nEUR\t12780\t30\tAccessory17\nUSD\t15300\t30\tAccessory17\nUSD\t15300\t30\tAccessory17\nDKK\t56600\t20\tAccessory17\nDKK\t58300\t20\tAccessory17\nEUR\t34000\t80\tAccessory17\nEUR\t34400\t80\tAccessory17\nEUR\t21250\t50\tAccessory17\nEUR\t3900\t10\tAccessory17\nEUR\t3900\t10\tAccessory17\nEUR\t3900\t10\tAccessory17\nEUR\t3900\t10\tAccessory17\nEUR\t19900\t50\tAccessory17\nGBP\t5650\t10\tAccessory17\nGBP\t70000\t200\tAccessory17\nGBP\t70000\t200\tAccessory17\nGBP\t70000\t200\tAccessory17\nUSD\t306\t1\tAccessory18\nUSD\t4605\t15\tAccessory18\nUSD\t7575\t25\tAccessory18\nUSD\t7500\t25\tAccessory18\nUSD\t7500\t25\tAccessory18\nUSD\t30000\t100\tAccessory18\nUSD\t30000\t100\tAccessory18\nUSD\t108000\t300\tAccessory18\nUSD\t29400\t100\tAccessory18\nEUR\t10200\t300\tAccessory19\nEUR\t3160\t100\tAccessory19\nEUR\t1300\t50\tAccessory19\nEUR\t39000\t1500\tAccessory19\nEUR\t2320\t80\tAccessory19\nEUR\t5300\t100\tAccessory20\nEUR\t60\t1\tAccessory20\nSEK\t28700\t70\tAccessory20\nSEK\t27300\t70\tAccessory20\nUSD\t7800\t150\tAccessory20\nUSD\t7800\t150\tAccessory20\nEUR\t4500\t100\tAccessory20\nUSD\t55\t1\tAccessory20\nEUR\t675\t15\tAccessory20\nEUR\t140000\t3500\tAccessory20\nEUR\t1975\t50\tAccessory20\nEUR\t9875\t250\tAccessory20\nUSD\t5300\t100\tAccessory20\nEUR\t22800\t600\tAccessory20\nEUR\t28800\t600\tAccessory20\nEUR\t2550\t50\tAccessory20\nEUR\t2550\t50\tAccessory20\nEUR\t5300\t100\tAccessory20\nEUR\t900\t20\tAccessory20\nEUR\t4600\t100\tAccessory20\nEUR\t1650\t30\tAccessory20\nEUR\t2450\t50\tAccessory20\nUSD\t1034\t22\tAccessory20\nEUR\t4900\t100\tAccessory20\nGBP\t9625\t250\tAccessory20\nEUR\t2820\t60\tAccessory20\nEUR\t1125\t25\tAccessory20\nEUR\t10750\t250\tAccessory20\nEUR\t5000\t100\tAccessory20\nEUR\t4500\t100\tAccessory20\nUSD\t26500\t500\tAccessory20\nEUR\t2500\t50\tAccessory20\nEUR\t2500\t50\tAccessory20\nEUR\t2925\t65\tAccessory20\nEUR\t140000\t3500\tAccessory20\nGBP\t2470\t65\tAccessory20\nEUR\t10500\t250\tAccessory20\nEUR\t960\t20\tAccessory20\nEUR\t960\t20\tAccessory20\nUSD\t5200\t100\tAccessory20\nEUR\t10400\t200\tAccessory20\nUSD\t2750\t50\tAccessory20\nEUR\t4050\t90\tAccessory20\nEUR\t2450\t50\tAccessory20\nEUR\t4400\t100\tAccessory20\nEUR\t9000\t200\tAccessory20\nEUR\t2650\t50\tAccessory20\nEUR\t5000\t100\tAccessory20\nEUR\t1800\t40\tAccessory20\nEUR\t9000\t200\tAccessory20\nEUR\t8600\t200\tAccessory20\nEUR\t21000\t500\tAccessory20\nEUR\t8600\t200\tAccessory20\nGBP\t15600\t400\tAccessory20\nUSD\t24000\t400\tAccessory20\nEUR\t318\t6\tAccessory20\nEUR\t360\t8\tAccessory20\nEUR\t360\t8\tAccessory20\nEUR\t1040\t20\tAccessory20\nEUR\t500\t10\tAccessory20\nEUR\t1590\t30\tAccessory20\nEUR\t1080\t20\tAccessory20\nEUR\t4400\t100\tAccessory20\nEUR\t4800\t100\tAccessory20\nEUR\t5000\t100\tAccessory20\nUSD\t1144\t22\tAccessory20\nEUR\t294\t7\tAccessory20\nEUR\t40000\t1000\tAccessory20\nSEK\t22000\t50\tAccessory20\nEUR\t40000\t1000\tAccessory20\nEUR\t237\t5\tAccessory20\nUSD\t2280\t40\tAccessory20\nSEK\t445000\t1000\tAccessory20\nEUR\t1060\t20\tAccessory20\nEUR\t39000\t1000\tAccessory20\nEUR\t11706\t300\tAccessory20\nEUR\t7804\t200\tAccessory20\nEUR\t3902\t100\tAccessory20\nEUR\t2173\t50\tAccessory20\nEUR\t2173\t50\tAccessory20\nEUR\t2173\t50\tAccessory20\nEUR\t459\t9\tAccessory20\nEUR\t2200\t50\tAccessory20\nEUR\t4900\t100\tAccessory20\nEUR\t4900\t100\tAccessory20\nUSD\t10800\t200\tAccessory20\nEUR\t4200\t100\tAccessory20\nEUR\t510\t10\tAccessory20\nUSD\t2450\t50\tAccessory20\nUSD\t4900\t100\tAccessory20\nEUR\t2300\t50\tAccessory20\nEUR\t4900\t100\tAccessory20\nEUR\t21200\t400\tAccessory20\nUSD\t56000\t1000\tAccessory20\nEUR\t7500\t150\tAccessory20\nEUR\t1200\t25\tAccessory20\nEUR\t2750\t50\tAccessory20\nEUR\t2750\t50\tAccessory20\nEUR\t2150\t50\tAccessory20\nEUR\t6975\t155\tAccessory20\nEUR\t66000\t1500\tAccessory20\nEUR\t2300\t50\tAccessory20\nEUR\t84000\t2000\tAccessory20\nEUR\t8800\t200\tAccessory20\nEUR\t147000\t3500\tAccessory20\nEUR\t8800\t200\tAccessory20\nUSD\t11900\t238\tAccessory20\nEUR\t867\t20\tAccessory20\nEUR\t5000\t100\tAccessory20\nEUR\t2200\t50\tAccessory20\nEUR\t11500\t250\tAccessory20\nEUR\t867\t20\tAccessory20\nEUR\t3290\t70\tAccessory20\nEUR\t1800\t40\tAccessory20\nEUR\t1800\t40\tAccessory20\nEUR\t34400\t800\tAccessory20\nEUR\t17500\t350\tAccessory20\nEUR\t17500\t350\tAccessory20\nEUR\t9400\t200\tAccessory20\nEUR\t5100\t100\tAccessory20\nEUR\t890\t20\tAccessory20\nEUR\t890\t20\tAccessory20\nEUR\t9400\t200\tAccessory20\nEUR\t200\t4\tAccessory20\nEUR\t102000\t2000\tAccessory20\nEUR\t5000\t100\tAccessory20\nEUR\t5500\t100\tAccessory20\nEUR\t48000\t1000\tAccessory20\nEUR\t3600\t90\tAccessory20\nEUR\t3600\t90\tAccessory20\nEUR\t2250\t50\tAccessory20\nEUR\t2250\t50\tAccessory20\nEUR\t2250\t50\tAccessory20\nEUR\t5800\t100\tAccessory20\nEUR\t5800\t100\tAccessory20\nEUR\t5800\t100\tAccessory20\nEUR\t5800\t100\tAccessory20\nEUR\t1800\t40\tAccessory20\nEUR\t45100\t1100\tAccessory20\nEUR\t1098900\t1100\tAccessory20\nEUR\t19380\t380\tAccessory20\nEUR\t500\t10\tAccessory20\nEUR\t500\t10\tAccessory20\nEUR\t2400\t50\tAccessory20\nEUR\t2650\t50\tAccessory20\nEUR\t4500\t100\tAccessory20\nEUR\t176\t4\tAccessory20\nEUR\t4500\t100\tAccessory20\nUSD\t4000\t50\tAccessory20\nEUR\t660\t15\tAccessory20\nEUR\t5100\t100\tAccessory20\nUSD\t55000\t1000\tAccessory20\nEUR\t470\t10\tAccessory20\nEUR\t1290\t30\tAccessory20\nEUR\t1290\t30\tAccessory20\nEUR\t1290\t30\tAccessory20\nGBP\t1950\t50\tAccessory20\nEUR\t550\t10\tAccessory20\nEUR\t550\t10\tAccessory20\nGBP\t1900\t50\tAccessory20\nUSD\t5000\t100\tAccessory20\nGBP\t1900\t50\tAccessory20\nEUR\t720\t15\tAccessory20\nEUR\t2120\t40\tAccessory20\nEUR\t2650\t50\tAccessory20\nEUR\t5000\t100\tAccessory20\nEUR\t27880\t680\tAccessory20\nUSD\t2750\t50\tAccessory20\nUSD\t55000\t1000\tAccessory20\nEUR\t1380\t30\tAccessory20\nEUR\t1380\t30\tAccessory20\nGBP\t1950\t50\tAccessory20\nUSD\t11000\t200\tAccessory20\nUSD\t2750\t50\tAccessory20\nUSD\t2750\t50\tAccessory20\nUSD\t1925\t35\tAccessory20\nGBP\t3500\t100\tAccessory20\nEUR\t18500\t500\tAccessory20\nEUR\t5600\t100\tAccessory20\nEUR\t5600\t100\tAccessory20\nEUR\t2400\t50\tAccessory20\nEUR\t2400\t50\tAccessory20\nEUR\t2400\t50\tAccessory20\nGBP\t3300\t100\tAccessory20\nGBP\t3300\t100\tAccessory20\nGBP\t4000\t100\tAccessory20\nEUR\t2400\t50\tAccessory20\nEUR\t9000\t180\tAccessory20\nEUR\t5046\t200\tAccessory20\nUSD\t29500\t500\tAccessory20\nEUR\t121840\t8000\tAccessory20\nEUR\t121840\t8000\tAccessory20\nEUR\t121840\t8000\tAccessory20\nUSD\t3180\t60\tAccessory20\nGBP\t2300\t50\tAccessory20\nUSD\t29500\t500\tAccessory20\nGBP\t3150\t75\tAccessory20\nGBP\t2300\t50\tAccessory20\nGBP\t4000\t100\tAccessory20\nGBP\t4000\t100\tAccessory20\nSEK\t46100\t100\tAccessory20\nGBP\t9500\t250\tAccessory20\nUSD\t560\t10\tAccessory20\nUSD\t570\t10\tAccessory20\nGBP\t9430\t230\tAccessory20\nGBP\t5727\t150\tAccessory20\nGBP\t4200\t100\tAccessory20\nGBP\t2400\t50\tAccessory20\nGBP\t6900\t150\tAccessory20\nGBP\t630\t18\tAccessory20\nGBP\t7667\t187\tAccessory20\nGBP\t2150\t50\tAccessory20\nGBP\t2150\t50\tAccessory20\nGBP\t16000\t500\tAccessory20\nGBP\t1886\t50\tAccessory20\nGBP\t1886\t50\tAccessory20\nGBP\t8200\t200\tAccessory20\nGBP\t8200\t200\tAccessory20\nGBP\t8200\t200\tAccessory20\nGBP\t4680\t120\tAccessory20\nGBP\t3100\t100\tAccessory20\nGBP\t4400\t100\tAccessory20\nGBP\t7800\t200\tAccessory20\nEUR\t47\t1\tAccessory20\nGBP\t12250\t250\tAccessory20\nGBP\t4100\t100\tAccessory20\nGBP\t4600\t100\tAccessory20\nEUR\t900\t20\tAccessory21\nDKK\t90000\t200\tAccessory21\nEUR\t3290\t70\tAccessory21\nEUR\t49\t1\tAccessory21\nEUR\t1800\t40\tAccessory21\nDKK\t85000\t200\tAccessory21\nEUR\t5000\t100\tAccessory21\nEUR\t900\t20\tAccessory21\nDKK\t190000\t200\tAccessory21\nEUR\t450\t10\tAccessory21\nEUR\t2400\t50\tAccessory21\nEUR\t10000\t200\tAccessory21\nEUR\t10000\t200\tAccessory21\nEUR\t2900\t100\tAccessory22\nEUR\t6750\t250\tAccessory22\nEUR\t1000\t50\tAccessory22\nEUR\t520\t20\tAccessory22\nEUR\t1300\t50\tAccessory22\nEUR\t580\t20\tAccessory22\nEUR\t2600\t100\tAccessory22\nEUR\t3000\t100\tAccessory22\nEUR\t1150\t50\tAccessory22\nEUR\t1750\t70\tAccessory22\nEUR\t7140\t340\tAccessory22\nEUR\t8500\t340\tAccessory22\nEUR\t8500\t340\tAccessory22\nUSD\t350\t10\tAccessory22\nUSD\t35\t1\tAccessory22\nEUR\t510\t20\tAccessory22\nGBP\t2500\t100\tAccessory22\nGBP\t6250\t250\tAccessory22\nGBP\t6250\t250\tAccessory22\nGBP\t2500\t100\tAccessory22\nEUR\t1800\t50\tAccessory22\nGBP\t6250\t250\tAccessory22\nEUR\t8100\t300\tAccessory22\nEUR\t8100\t300\tAccessory22\nGBP\t3000\t100\tAccessory22\nGBP\t1400\t50\tAccessory22\nGBP\t9350\t425\tAccessory22\nGBP\t4400\t200\tAccessory22\nGBP\t8800\t400\tAccessory22\nGBP\t8250\t375\tAccessory22\nGBP\t4400\t200\tAccessory22\nGBP\t1650\t50\tAccessory22\nEUR\t1500\t50\tAccessory23\nEUR\t6000\t200\tAccessory23\nEUR\t3500\t100\tAccessory23\nEUR\t8580\t330\tAccessory23\nEUR\t8580\t330\tAccessory23\nEUR\t2900\t100\tAccessory23\nEUR\t8700\t300\tAccessory23\nEUR\t29000\t1000\tAccessory23\nEUR\t29000\t1000\tAccessory23\nEUR\t701\t25\tAccessory23\nUSD\t27\t1\tAccessory23\nEUR\t1100\t50\tAccessory23\nEUR\t1400\t50\tAccessory23\nUSD\t1400\t50\tAccessory23\nEUR\t370\t10\tAccessory23\nEUR\t250\t10\tAccessory23\nEUR\t185\t5\tAccessory23\nEUR\t185\t5\tAccessory23\nEUR\t270\t10\tAccessory23\nEUR\t270\t10\tAccessory23\nEUR\t1750\t50\tAccessory23\nEUR\t1750\t50\tAccessory23\nEUR\t1750\t50\tAccessory23\nEUR\t1110\t30\tAccessory23\nDKK\t6925\t25\tAccessory23\nUSD\t1500\t50\tAccessory23\nUSD\t33\t1\tAccessory23\nUSD\t33\t1\tAccessory23\nUSD\t33\t1\tAccessory23\nUSD\t33\t1\tAccessory23\nUSD\t33\t1\tAccessory23\nUSD\t33\t1\tAccessory23\nGBP\t4640\t40\tAccessory24\nGBP\t4640\t40\tAccessory24\nEUR\t2340\t20\tAccessory24\nEUR\t575\t5\tAccessory24\nEUR\t3960\t33\tAccessory24\nEUR\t3960\t33\tAccessory24\nEUR\t4980\t60\tAccessory25\nSEK\t54390\t70\tAccessory25\nSEK\t51800\t70\tAccessory25\nEUR\t6208\t80\tAccessory25\nEUR\t4450\t50\tAccessory25\nEUR\t25500\t300\tAccessory25\nEUR\t94470\t1000\tAccessory25\nEUR\t1800\t20\tAccessory25\nEUR\t4250\t50\tAccessory25\nEUR\t820\t10\tAccessory25\nGBP\t16800\t200\tAccessory25\nEUR\t4100\t50\tAccessory25\nGBP\t16800\t200\tAccessory25\nEUR\t4200\t50\tAccessory25\nEUR\t1955\t23\tAccessory25\nEUR\t4250\t50\tAccessory25\nEUR\t100000\t1000\tAccessory25\nDKK\t550\t1\tAccessory25\nEUR\t4900\t50\tAccessory25\nEUR\t2850\t30\tAccessory25\nEUR\t920\t10\tAccessory25\nEUR\t2425\t25\tAccessory25\nEUR\t3800\t50\tAccessory25\nEUR\t7600\t100\tAccessory25\nEUR\t5100\t60\tAccessory25\nEUR\t5100\t60\tAccessory25\nSEK\t37344\t50\tAccessory25\nEUR\t4100\t50\tAccessory25\nEUR\t8200\t100\tAccessory25\nEUR\t8200\t100\tAccessory25\nUSD\t2200\t20\tAccessory25\nUSD\t2060\t20\tAccessory25\nEUR\t4950\t50\tAccessory25\nEUR\t2000\t20\tAccessory25\nEUR\t19800\t200\tAccessory25\nUSD\t1632\t16\tAccessory25\nEUR\t2350\t25\tAccessory25\nEUR\t8500\t100\tAccessory25\nEUR\t500\t5\tAccessory25\nEUR\t500\t5\tAccessory25\nEUR\t2520\t30\tAccessory25\nEUR\t7200\t90\tAccessory25\nUSD\t10500\t100\tAccessory25\nEUR\t1960\t20\tAccessory25\nEUR\t40000\t500\tAccessory25\nEUR\t11280\t120\tAccessory25\nEUR\t11400\t120\tAccessory25\nUSD\t2825\t25\tAccessory25\nEUR\t11280\t120\tAccessory25\nEUR\t8800\t100\tAccessory25\nEUR\t2520\t30\tAccessory25\nEUR\t3480\t40\tAccessory25\nEUR\t4850\t50\tAccessory25\nUSD\t1020\t10\tAccessory25\nEUR\t8900\t100\tAccessory25\nEUR\t8900\t100\tAccessory25\nEUR\t2200\t25\tAccessory25\nEUR\t8400\t100\tAccessory25\nEUR\t980\t10\tAccessory25\nEUR\t4583\t50\tAccessory25\nEUR\t9000\t100\tAccessory25\nUSD\t51000\t500\tAccessory25\nEUR\t4500\t50\tAccessory25\nEUR\t4500\t50\tAccessory25\nEUR\t1960\t20\tAccessory25\nEUR\t24000\t300\tAccessory25\nEUR\t4300\t50\tAccessory25\nEUR\t980\t10\tAccessory25\nSEK\t87000\t100\tAccessory25\nUSD\t784\t7\tAccessory25\nEUR\t4500\t50\tAccessory25\nEUR\t2000\t20\tAccessory25\nEUR\t42000\t500\tAccessory25\nEUR\t261\t3\tAccessory25\nEUR\t7830\t90\tAccessory25\nEUR\t273\t3\tAccessory25\nEUR\t4100\t50\tAccessory25\nEUR\t3750\t50\tAccessory25\nEUR\t16800\t200\tAccessory25\nUSD\t8900\t100\tAccessory25\nEUR\t12500\t100\tAccessory25\nEUR\t261\t3\tAccessory25\nUSD\t9000\t100\tAccessory25\nUSD\t4450\t50\tAccessory25\nEUR\t16800\t200\tAccessory25\nEUR\t40000\t500\tAccessory25\nEUR\t16000\t200\tAccessory25\nUSD\t53400\t600\tAccessory25\nEUR\t16000\t200\tAccessory25\nEUR\t5000\t50\tAccessory25\nEUR\t5000\t50\tAccessory25\nEUR\t16000\t200\tAccessory25\nEUR\t5000\t50\tAccessory25\nEUR\t712\t8\tAccessory25\nEUR\t950\t10\tAccessory25\nUSD\t11000\t100\tAccessory25\nEUR\t25500\t300\tAccessory25\nEUR\t25500\t300\tAccessory25\nDKK\t18625\t25\tAccessory25\nEUR\t4500\t50\tAccessory25\nEUR\t900\t10\tAccessory25\nEUR\t9680\t110\tAccessory25\nEUR\t1800\t20\tAccessory25\nEUR\t9680\t110\tAccessory25\nEUR\t4500\t50\tAccessory25\nEUR\t3600\t40\tAccessory25\nEUR\t4500\t50\tAccessory25\nEUR\t1800\t20\tAccessory25\nEUR\t3600\t40\tAccessory25\nEUR\t440\t5\tAccessory25\nUSD\t204000\t2000\tAccessory25\nEUR\t1800\t20\tAccessory25\nEUR\t3600\t40\tAccessory25\nEUR\t4500\t50\tAccessory25\nEUR\t1800\t20\tAccessory25\nEUR\t5000\t50\tAccessory25\nEUR\t1900\t20\tAccessory25\nUSD\t5846\t50\tAccessory25\nEUR\t2040\t20\tAccessory25\nEUR\t2700\t30\tAccessory25\nEUR\t1000\t10\tAccessory25\nUSD\t300\t3\tAccessory25\nEUR\t25500\t300\tAccessory25\n"},{"type":"HTML","data":"<div class=\"result-alert alert-warning\" role=\"alert\"><button type=\"button\" class=\"close\" data-dismiss=\"alert\" aria-label=\"Close\"><span aria-hidden=\"true\">&times;</span></button><strong>Output is truncated</strong> to 1000 rows. Learn more about <strong>zeppelin.spark.maxResult</strong></div>"}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://ip-172-31-0-164.ec2.internal:4040/jobs/job?id=2"],"interpreterSettingId":"spark"}},"apps":[],"jobName":"paragraph_1551442563161_11772142","id":"20190114-100716_1238994160","dateCreated":"2019-03-01T12:16:03+0000","dateStarted":"2019-03-01T12:25:58+0000","dateFinished":"2019-03-01T12:25:58+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:15773"},{"text":"// Spark transform on data\n// function used: filter(contains, compare), groupBy, agg, sort, distinct\nval transform_filter = select_column_toDouble.filter($\"Product_ID\".contains(\"MTM\"))\nval transofrm_groupBy = transform_filter.groupBy($\"Product_ID\").agg(sum(\"Quantity\").alias(\"Sum_Quantity\")).sort($\"Sum_Quantity\".desc)\ntransform_filter.filter(\"Sum(Quantity) > avg(Quantity)\")\nval action_count = transform_filter.select($\"Currency\").distinct()\n","user":"anonymous","dateUpdated":"2019-03-01T12:50:31+0000","config":{"tableHide":true,"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"transform_filter: org.apache.spark.sql.Dataset[org.apache.spark.sql.Row] = [Currency: string, Net_Price: int ... 2 more fields]\ntransofrm_groupBy: org.apache.spark.sql.Dataset[org.apache.spark.sql.Row] = [Product_ID: string, Sum_Quantity: bigint]\nres71: org.apache.spark.sql.Dataset[org.apache.spark.sql.Row] = [Currency: string, Net_Price: int ... 2 more fields]\naction_count: org.apache.spark.sql.Dataset[org.apache.spark.sql.Row] = [Currency: string]\n"}]},"apps":[],"jobName":"paragraph_1551442563162_-1168343463","id":"20190122-070137_1328974622","dateCreated":"2019-03-01T12:16:03+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:15774"},{"text":"// Spark action on data\n// function used: show, count\naction_count.show()\naction_count.count()","user":"anonymous","dateUpdated":"2019-03-01T12:50:31+0000","config":{"tableHide":true,"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+--------+\n|Currency|\n+--------+\n|     DKK|\n|     GBP|\n|     CHF|\n|     EUR|\n|     NOK|\n|     USD|\n|     SEK|\n+--------+\n\nres77: Long = 7\n"}]},"apps":[],"jobName":"paragraph_1551442563162_-1360929369","id":"20190122-071515_1297089460","dateCreated":"2019-03-01T12:16:03+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:15775"},{"text":"//**********************************************************//\n//                 Welcome to Lab 3                         //\n//**********************************************************//","user":"anonymous","dateUpdated":"2019-03-01T12:50:31+0000","config":{"tableHide":true,"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1551442563162_-1898137944","id":"20190223-071217_1853255140","dateCreated":"2019-03-01T12:16:03+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:15776"},{"text":"// 單一AcountID(user)對上Product Family(product), rating表示購買次數\nval raw_data = Lab2_loaddata.select(\n    $\"Quotation: Quotation ID\",\n    $\"Display Quantity\",\n    $\"Account ID\",\n    $\"Product: Product Family\",\n    $\"PRODUCT ID\",$\"Description\")\nval user_product = raw_data.select(\n    $\"Account ID\".alias(\"user\"), \n    $\"PRODUCT ID\".alias(\"product\"),\n    $\"Display Quantity\".alias(\"number\")).groupBy(\"user\",\"product\").agg(count(\"number\").alias(\"rating\")).toDF() \n    \nraw_data.printSchema()\nraw_data.createOrReplaceTempView(\"raw_data\")\n","user":"anonymous","dateUpdated":"2019-03-01T12:50:32+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala","tableHide":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"raw_data: org.apache.spark.sql.DataFrame = [Quotation: Quotation ID: string, Display Quantity: string ... 4 more fields]\nuser_product: org.apache.spark.sql.DataFrame = [user: string, product: string ... 1 more field]\nroot\n |-- Quotation: Quotation ID: string (nullable = true)\n |-- Display Quantity: string (nullable = true)\n |-- Account ID: string (nullable = true)\n |-- Product: Product Family: string (nullable = true)\n |-- PRODUCT ID: string (nullable = true)\n |-- Description: string (nullable = true)\n\n"}]},"apps":[],"jobName":"paragraph_1551443414446_1408762278","id":"20190301-123014_360034308","dateCreated":"2019-03-01T12:30:14+0000","dateStarted":"2019-03-01T12:34:30+0000","dateFinished":"2019-03-01T12:34:31+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:15777"},{"text":"%sql\nselect * from raw_data limit 20","user":"anonymous","dateUpdated":"2019-03-01T12:50:32+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"Quotation: Quotation ID":"string","Display Quantity":"string","Account ID":"string","Product: Product Family":"string","PRODUCT ID":"string","Description":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{}}}},"editorSetting":{"language":"sql","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/sql","tableHide":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"Quotation: Quotation ID\tDisplay Quantity\tAccount ID\tProduct: Product Family\tPRODUCT ID\tDescription\nQ-00007446\t20\t001d000000HisDM\t10MAS1P800\tMTM1\t I56500 4G 1TB\nQ-00043303\t105\t001d000000HisDM\t10MAS4JM00\tMTM1\t I56500 4G 1TB W10DG\nQ-00023615\t60\t001d000000HisDM\t10MAS4JM00\tMTM1\t I56500 4G 1TB W10DG\nQ-00028519\t1000\t001b0000002npdD\t4X90Q93976\tAccessory1\t ThinkStation Mini DP to HDMI Adapter\nQ-00033211\t755\t001b0000002npeT\t4X90Q93976\tAccessory1\t ThinkStation Mini DP to HDMI Adapter\nQ-00039589\t1\t001b000000hc8Ef\t4X90Q93976\tAccessory1\t ThinkStation Mini DP to HDMI Adapter\nQ-00040248\t20\t001b000000wqfMp\t4X90Q93976\tAccessory1\t ThinkStation Mini DP to HDMI Adapter\nQ-00051236\t200\t001b000000pQKcX\t4X90Q93976\tAccessory1\t ThinkStation Mini DP to HDMI Adapter\nQ-00058591\t300\t0010X00004DviVw\t4X90Q93976\tAccessory1\t ThinkStation Mini DP to HDMI Adapter\nQ-00051948\t50\t001b000003otFfR\t4X90Q93976\tAccessory1\t ThinkStation Mini DP to HDMI Adapter\nQ-00058472\t100\t001d000000Hiufr\t4X90Q93976\tAccessory1\t ThinkStation Mini DP to HDMI Adapter\nQ-00040898\t50\t001b0000002nnpS\t4XH0Q89603\tAccessory2\t ThinkStation VROC Key Module by Intel -Premium\nQ-00024192\t50\t001b000000WlVmF\t0A36236\tAccessory3\t?ThinkPad 170W AC adapter for W520/W530 - Switzerland\nQ-00045816\t200\t001d000000HiuZp\t0A36235\tAccessory3\t?ThinkPad 170W AC adapter for W520/W530 - UK/SA/HK\nQ-00017414\t100\t001d000000Hiw9n\t0A36235\tAccessory3\t?ThinkPad 170W AC adapter for W520/W530 - UK/SA/HK\nQ-00050070\t100\t001d000000Hiw9n\t0A36235\tAccessory3\t?ThinkPad 170W AC adapter for W520/W530 - UK/SA/HK\nQ-00019018\t100\t001d000000Hiw9n\t0A36235\tAccessory3\t?ThinkPad 170W AC adapter for W520/W530 - UK/SA/HK\nQ-00035985\t5\t001b000000hc9lM\tGX40Q53788\tAccessory4\t14 Inch Laptop Sleeve\nQ-00053254\t500\t001b000000ofB0m\tGX40Q53788\tAccessory4\t14 Inch Laptop Sleeve\nQ-00065588\t500\t001b000000ofB0m\tGX40Q53788\tAccessory4\t14 Inch Laptop Sleeve\n"}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://ip-172-31-0-164.ec2.internal:4040/jobs/job?id=3"],"interpreterSettingId":"spark"}},"apps":[],"jobName":"paragraph_1551443451758_-269248735","id":"20190301-123051_440802165","dateCreated":"2019-03-01T12:30:51+0000","dateStarted":"2019-03-01T12:31:08+0000","dateFinished":"2019-03-01T12:31:16+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:15778"},{"text":"/* 將User與product分別配上獨立ID，一出現次數由大到小排序後加上ID\n此轉換是為了 CF_ALS 模型格式需求 \nuser: [Int]\nproduct: [Int]\nrating: [Double]\n*/\nval userIndexer = new StringIndexer().setInputCol(\"user\").setOutputCol(\"userID\").setHandleInvalid(\"keep\")\nval indexed = userIndexer.fit(user_product).transform(user_product)\nval productIndexer = new StringIndexer().setInputCol(\"product\").setOutputCol(\"productID\").setHandleInvalid(\"keep\")\n\nval whole = productIndexer.fit(indexed).transform(indexed)\n\nval user_mapping = whole.select(\"user\",\"userID\").distinct.toDF()\nval product_mapping = whole.select(\"product\",\"productID\").distinct.toDF()\nval whole_select_rating = whole.select($\"userID\".cast(\"int\"),$\"productID\".cast(\"int\"),$\"rating\".cast(\"double\"))\n\n//  CF 準備\nval unique_product = whole_select_rating.dropDuplicates(\"productID\")\nval unique_user = whole_select_rating.dropDuplicates(\"userID\")\nval join = unique_user.union(unique_product)\nval unique_product_user = join.dropDuplicates()\nval test_notyet = whole_select_rating.except(unique_product_user)\n\nval Array(training, test) = test_notyet.randomSplit(Array[Double](0.7, 0.3), seed= 1234L)\nval train_final = unique_product_user.union(training)\nval test_final = test\n\n\nval tableRDD = whole_select_rating.rdd.map(r => Rating(\n  r.getAs[Int](\"userID\"), r.getAs[Int](\"productID\"), r.getAs[Double](\"rating\")\n))\n\nval trainRDD = train_final.rdd.map(r => Rating(\n  r.getAs[Int](\"userID\"), r.getAs[Int](\"productID\"), r.getAs[Double](\"rating\")\n))","user":"anonymous","dateUpdated":"2019-03-01T12:50:31+0000","config":{"tableHide":true,"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"userIndexer: org.apache.spark.ml.feature.StringIndexer = strIdx_f50254cf07f2\nindexed: org.apache.spark.sql.DataFrame = [user: string, product: string ... 2 more fields]\nproductIndexer: org.apache.spark.ml.feature.StringIndexer = strIdx_04aed839ae89\nwhole: org.apache.spark.sql.DataFrame = [user: string, product: string ... 3 more fields]\nuser_mapping: org.apache.spark.sql.DataFrame = [user: string, userID: double]\nproduct_mapping: org.apache.spark.sql.DataFrame = [product: string, productID: double]\nwhole_select_rating: org.apache.spark.sql.DataFrame = [userID: int, productID: int ... 1 more field]\nunique_product: org.apache.spark.sql.Dataset[org.apache.spark.sql.Row] = [userID: int, productID: int ... 1 more field]\nunique_user: org.apache.spark.sql.Dataset[org.apache.spark.sql.Row] = [userID: int, productID: int ... 1 more field]\njoin: org.apache.spark.sql.Dataset[org.apache.spark.sql.Row] = [userID: int, productID: int ... 1 more field]\nunique_product_user: org.apache.spark.sql.Dataset[org.apache.spark.sql.Row] = [userID: int, productID: int ... 1 more field]\ntest_notyet: org.apache.spark.sql.Dataset[org.apache.spark.sql.Row] = [userID: int, productID: int ... 1 more field]\ntraining: org.apache.spark.sql.Dataset[org.apache.spark.sql.Row] = [userID: int, productID: int ... 1 more field]\ntest: org.apache.spark.sql.Dataset[org.apache.spark.sql.Row] = [userID: int, productID: int ... 1 more field]\ntrain_final: org.apache.spark.sql.Dataset[org.apache.spark.sql.Row] = [userID: int, productID: int ... 1 more field]\ntest_final: org.apache.spark.sql.Dataset[org.apache.spark.sql.Row] = [userID: int, productID: int ... 1 more field]\ntableRDD: org.apache.spark.rdd.RDD[org.apache.spark.mllib.recommendation.Rating] = MapPartitionsRDD[50] at map at <console>:67\ntrainRDD: org.apache.spark.rdd.RDD[org.apache.spark.mllib.recommendation.Rating] = MapPartitionsRDD[92] at map at <console>:79\n"}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://ip-172-31-0-164.ec2.internal:4040/jobs/job?id=4","http://ip-172-31-0-164.ec2.internal:4040/jobs/job?id=5","http://ip-172-31-0-164.ec2.internal:4040/jobs/job?id=6"],"interpreterSettingId":"spark"}},"apps":[],"jobName":"paragraph_1551442563162_1478537984","id":"20181227-090418_525674266","dateCreated":"2019-03-01T12:16:03+0000","dateStarted":"2019-03-01T12:34:51+0000","dateFinished":"2019-03-01T12:36:54+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:15779"},{"text":"val model = ALS.trainImplicit(trainRDD, 8, 8, 0.01, 40)","user":"anonymous","dateUpdated":"2019-03-01T12:50:31+0000","config":{"tableHide":true,"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"ERROR","msg":[{"type":"TEXT","data":"org.apache.spark.SparkException: Job 9 cancelled part of cancelled job group zeppelin-2E5KKKETF-20190227-035535_1572264869\n  at org.apache.spark.scheduler.DAGScheduler.org$apache$spark$scheduler$DAGScheduler$$failJobAndIndependentStages(DAGScheduler.scala:1803)\n  at org.apache.spark.scheduler.DAGScheduler.handleJobCancellation(DAGScheduler.scala:1738)\n  at org.apache.spark.scheduler.DAGScheduler$$anonfun$handleJobGroupCancelled$1.apply$mcVI$sp(DAGScheduler.scala:851)\n  at org.apache.spark.scheduler.DAGScheduler$$anonfun$handleJobGroupCancelled$1.apply(DAGScheduler.scala:851)\n  at org.apache.spark.scheduler.DAGScheduler$$anonfun$handleJobGroupCancelled$1.apply(DAGScheduler.scala:851)\n  at scala.collection.mutable.HashSet.foreach(HashSet.scala:78)\n  at org.apache.spark.scheduler.DAGScheduler.handleJobGroupCancelled(DAGScheduler.scala:851)\n  at org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.doOnReceive(DAGScheduler.scala:1993)\n  at org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.onReceive(DAGScheduler.scala:1973)\n  at org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.onReceive(DAGScheduler.scala:1962)\n  at org.apache.spark.util.EventLoop$$anon$1.run(EventLoop.scala:48)\n  at org.apache.spark.scheduler.DAGScheduler.runJob(DAGScheduler.scala:682)\n  at org.apache.spark.SparkContext.runJob(SparkContext.scala:2034)\n  at org.apache.spark.SparkContext.runJob(SparkContext.scala:2055)\n  at org.apache.spark.SparkContext.runJob(SparkContext.scala:2074)\n  at org.apache.spark.SparkContext.runJob(SparkContext.scala:2099)\n  at org.apache.spark.rdd.RDD.count(RDD.scala:1168)\n  at org.apache.spark.ml.recommendation.ALS$.train(ALS.scala:931)\n  at org.apache.spark.mllib.recommendation.ALS.run(ALS.scala:255)\n  at org.apache.spark.mllib.recommendation.ALS$.trainImplicit(ALS.scala:428)\n  at org.apache.spark.mllib.recommendation.ALS$.trainImplicit(ALS.scala:447)\n  ... 56 elided\n"}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://ip-172-31-0-164.ec2.internal:4040/jobs/job?id=7","http://ip-172-31-0-164.ec2.internal:4040/jobs/job?id=8","http://ip-172-31-0-164.ec2.internal:4040/jobs/job?id=9"],"interpreterSettingId":"spark"}},"apps":[],"jobName":"paragraph_1551442563163_1757126538","id":"20190227-035535_1572264869","dateCreated":"2019-03-01T12:16:03+0000","dateStarted":"2019-03-01T12:38:11+0000","dateFinished":"2019-03-01T12:40:47+0000","status":"ABORT","progressUpdateIntervalMs":500,"$$hashKey":"object:15780"},{"text":"val model = MatrixFactorizationModel.load(sc, \"s3://lenovorecosys/Model/Model_Demo\")","user":"anonymous","dateUpdated":"2019-03-01T12:50:31+0000","config":{"tableHide":true,"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"model: org.apache.spark.mllib.recommendation.MatrixFactorizationModel = org.apache.spark.mllib.recommendation.MatrixFactorizationModel@7022ff85\n"}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://ip-172-31-0-164.ec2.internal:4040/jobs/job?id=10","http://ip-172-31-0-164.ec2.internal:4040/jobs/job?id=11","http://ip-172-31-0-164.ec2.internal:4040/jobs/job?id=12","http://ip-172-31-0-164.ec2.internal:4040/jobs/job?id=13","http://ip-172-31-0-164.ec2.internal:4040/jobs/job?id=14","http://ip-172-31-0-164.ec2.internal:4040/jobs/job?id=15"],"interpreterSettingId":"spark"}},"apps":[],"jobName":"paragraph_1551442563163_80010394","id":"20190227-041548_1558920041","dateCreated":"2019-03-01T12:16:03+0000","dateStarted":"2019-03-01T12:40:59+0000","dateFinished":"2019-03-01T12:41:15+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:15781"},{"text":"val recommend_20Items = model.recommendProductsForUsers(20)\nval product = product_mapping.rdd.map(array=>(array(1),array(0))).collectAsMap()\n\n\nval allRecs = recommend_20Items.map{ case (userId, array) =>\n\n  val recommendedIds = array.map{ case Rating(user,product,rating) => (product) }\n  val product_name = recommendedIds.map{case id => product(id).toString}.toSeq\n  (userId, product_name)\n    }\n\n\nval userRecs_array = allRecs.toDF.select($\"_1\".alias(\"UserID\"),$\"_2\".alias(\"Product_Array\"))\nimport org.apache.spark.sql.Column\ndef getColAtIndex(id:Int): Column = col(s\"Product_Array\")(id).as(s\"product_${id+1}\")\nval columns: IndexedSeq[Column] = col(\"userID\") +: (0 to 19).map(getColAtIndex)   //Here, instead of 2, you can give the value of n\nval userRecs_array_flat = userRecs_array.select(columns: _*)\n\nval userRecs_mappingID = userRecs_array_flat.join(user_mapping, Seq(\"userID\"), \"left_outer\")\n","user":"anonymous","dateUpdated":"2019-03-01T12:50:31+0000","config":{"tableHide":true,"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"recommend_20Items: org.apache.spark.rdd.RDD[(Int, Array[org.apache.spark.mllib.recommendation.Rating])] = MapPartitionsRDD[125] at map at MatrixFactorizationModel.scala:218\nproduct: scala.collection.Map[Any,Any] = Map(137.0 -> MTM203, 891.0 -> Accessory735, 1205.0 -> Accessory166, 550.0 -> Accessory705, 864.0 -> Accessory246, 146.0 -> MTM381, 559.0 -> MTM341, 218.0 -> MTM300, 568.0 -> Accessory194, 227.0 -> MTM35, 765.0 -> Accessory586, 1115.0 -> MTM347, 92.0 -> Accessory556, 774.0 -> MTM80, 433.0 -> Accessory510, 1187.0 -> Accessory720, 846.0 -> Accessory278, 1160.0 -> Accessory14, 442.0 -> Accessory26, 101.0 -> MTM409, 1196.0 -> Accessory670, 200.0 -> MTM323, 855.0 -> MTM345, 173.0 -> MTM314, 514.0 -> Accessory536, 209.0 -> MTM114, 523.0 -> MTM123, 182.0 -> Accessory336, 254.0 -> MTM225, 191.0 -> MTM272, 720.0 -> MTM394, 1061.0 -> Accessory97, 1070.0 -> Accessory629, 729.0 -> Accessory24, 738.0 -> Accessory612, 1142.0 -> Accessory590, 828.0 -> Accessory6...allRecs: org.apache.spark.rdd.RDD[(Int, Seq[String])] = MapPartitionsRDD[137] at map at <console>:75\nuserRecs_array: org.apache.spark.sql.DataFrame = [UserID: int, Product_Array: array<string>]\nimport org.apache.spark.sql.Column\ngetColAtIndex: (id: Int)org.apache.spark.sql.Column\ncolumns: IndexedSeq[org.apache.spark.sql.Column] = Vector(userID, Product_Array[0] AS `product_1`, Product_Array[1] AS `product_2`, Product_Array[2] AS `product_3`, Product_Array[3] AS `product_4`, Product_Array[4] AS `product_5`, Product_Array[5] AS `product_6`, Product_Array[6] AS `product_7`, Product_Array[7] AS `product_8`, Product_Array[8] AS `product_9`, Product_Array[9] AS `product_10`, Product_Array[10] AS `product_11`, Product_Array[11] AS `product_12`, Product_Array[12] AS `product_13`, Product_Array[13] AS `product_14`, Product_Array[14] AS `product_15`, Product_Array[15] AS `product_16`, Product_Array[16] AS `product_17`, Product_Array[17] AS `product_18`, Product_Array[18] AS `product_19`, Product_Array[19] AS `product_20`)\nuserRecs_array_flat: org.apache.spark.sql.DataFrame = [userID: int, product_1: string ... 19 more fields]\nuserRecs_mappingID: org.apache.spark.sql.DataFrame = [userID: int, product_1: string ... 20 more fields]\n"}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://ip-172-31-0-164.ec2.internal:4040/jobs/job?id=16"],"interpreterSettingId":"spark"}},"apps":[],"jobName":"paragraph_1551442563163_-1672886732","id":"20181227-090635_907211718","dateCreated":"2019-03-01T12:16:03+0000","dateStarted":"2019-03-01T12:41:19+0000","dateFinished":"2019-03-01T12:41:55+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:15782"},{"text":"userRecs_mappingID.createOrReplaceTempView(\"userRecs_mappingID\")","user":"anonymous","dateUpdated":"2019-03-01T12:50:31+0000","config":{"tableHide":true,"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1551442563164_1818776655","id":"20190227-073614_1331845991","dateCreated":"2019-03-01T12:16:03+0000","dateStarted":"2019-03-01T12:42:33+0000","dateFinished":"2019-03-01T12:42:33+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:15783"},{"text":"%sql\nselect * from userRecs_mappingID order by userID asc limit 50","user":"anonymous","dateUpdated":"2019-03-01T12:50:31+0000","config":{"tableHide":true,"editorSetting":{"language":"sql","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/sql","fontSize":9,"results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"userID":"string","product_1":"string","product_2":"string","product_3":"string","product_4":"string","product_5":"string","product_6":"string","product_7":"string","product_8":"string","product_9":"string","product_10":"string","product_11":"string","product_12":"string","product_13":"string","product_14":"string","product_15":"string","product_16":"string","product_17":"string","product_18":"string","product_19":"string","product_20":"string","user":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{}}}},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"userID\tproduct_1\tproduct_2\tproduct_3\tproduct_4\tproduct_5\tproduct_6\tproduct_7\tproduct_8\tproduct_9\tproduct_10\tproduct_11\tproduct_12\tproduct_13\tproduct_14\tproduct_15\tproduct_16\tproduct_17\tproduct_18\tproduct_19\tproduct_20\tuser\n0\tAccessory599\tAccessory607\tAccessory307\tAccessory597\tAccessory410\tMTM234\tMTM332\tMTM350\tAccessory594\tMTM303\tAccessory449\tMTM402\tMTM405\tAccessory687\tMTM330\tAccessory577\tAccessory578\tAccessory602\tMTM65\tAccessory84\t001b000000kPHiU\n1\tAccessory607\tAccessory672\tMTM352\tAccessory410\tAccessory307\tMTM67\tAccessory594\tAccessory468\tAccessory406\tAccessory579\tAccessory677\tAccessory688\tAccessory718\tAccessory591\tMTM339\tMTM331\tAccessory179\tAccessory231\tAccessory658\tAccessory708\t001b000000mvXto\n2\tAccessory688\tMTM374\tAccessory677\tAccessory729\tMTM402\tAccessory410\tAccessory597\tMTM375\tMTM405\tAccessory268\tAccessory718\tMTM365\tAccessory602\tAccessory578\tMTM330\tAccessory512\tMTM409\tAccessory449\tAccessory347\tMTM328\t001b0000002nqDr\n3\tAccessory597\tAccessory688\tAccessory410\tAccessory579\tMTM402\tAccessory467\tMTM234\tAccessory449\tAccessory599\tAccessory25\tAccessory578\tMTM65\tAccessory607\tAccessory319\tMTM330\tAccessory595\tAccessory602\tMTM405\tMTM333\tAccessory230\t001b000003saA9h\n4\tAccessory672\tMTM67\tMTM375\tMTM370\tAccessory649\tAccessory512\tAccessory580\tMTM327\tMTM268\tAccessory743\tAccessory449\tAccessory678\tAccessory718\tAccessory597\tAccessory410\tAccessory268\tAccessory307\tAccessory470\tAccessory688\tAccessory708\t001b0000003Z5iV\n5\tAccessory268\tAccessory718\tMTM375\tAccessory512\tAccessory649\tMTM365\tAccessory513\tAccessory688\tAccessory743\tAccessory702\tAccessory347\tMTM372\tMTM64\tMTM279\tAccessory409\tAccessory691\tAccessory305\tAccessory597\tMTM333\tAccessory669\t001b0000003Z7Jy\n6\tAccessory607\tAccessory597\tAccessory307\tAccessory579\tAccessory410\tAccessory84\tAccessory230\tAccessory672\tAccessory595\tAccessory659\tAccessory594\tAccessory688\tAccessory231\tAccessory25\tAccessory708\tAccessory658\tAccessory468\tMTM353\tMTM377\tAccessory656\t001b0000002oLpl\n7\tAccessory410\tAccessory599\tAccessory607\tMTM330\tAccessory579\tAccessory688\tAccessory578\tAccessory591\tMTM402\tAccessory594\tAccessory677\tAccessory595\tAccessory597\tMTM332\tAccessory687\tMTM234\tMTM405\tAccessory25\tAccessory602\tAccessory449\t001b000003Wt9Ts\n8\tAccessory579\tAccessory683\tAccessory513\tMTM65\tAccessory607\tAccessory718\tAccessory202\tAccessory687\tAccessory406\tAccessory84\tAccessory468\tAccessory319\tMTM68\tMTM64\tAccessory598\tAccessory7\tAccessory656\tMTM402\tAccessory605\tAccessory677\t001b000003IEYU1\n9\tAccessory591\tAccessory607\tAccessory579\tMTM332\tAccessory677\tAccessory468\tAccessory594\tAccessory687\tAccessory659\tAccessory652\tAccessory84\tAccessory599\tMTM303\tMTM330\tAccessory406\tAccessory410\tMTM106\tAccessory307\tAccessory389\tAccessory230\t001d000000Hiy3z\n10\tAccessory599\tAccessory687\tMTM330\tMTM405\tAccessory602\tAccessory577\tAccessory410\tMTM402\tAccessory578\tAccessory607\tAccessory729\tAccessory449\tMTM376\tAccessory677\tMTM150\tAccessory389\tAccessory406\tAccessory688\tMTM234\tMTM350\t001b0000002nq7F\n11\tAccessory268\tAccessory513\tMTM64\tMTM374\tAccessory595\tMTM333\tAccessory410\tMTM365\tMTM375\tAccessory241\tAccessory512\tAccessory649\tMTM340\tAccessory467\tAccessory743\tAccessory578\tAccessory305\tAccessory702\tMTM322\tAccessory669\t001d000000HisQ3\n12\tAccessory268\tAccessory595\tAccessory718\tAccessory649\tAccessory468\tAccessory607\tMTM64\tAccessory743\tMTM375\tAccessory410\tMTM374\tAccessory513\tAccessory512\tAccessory305\tMTM102\tAccessory702\tAccessory467\tMTM365\tMTM371\tMTM322\t001b000000wqhxw\n13\tAccessory579\tAccessory607\tAccessory683\tMTM330\tAccessory84\tAccessory468\tAccessory688\tAccessory677\tAccessory230\tAccessory659\tAccessory594\tMTM402\tAccessory25\tMTM332\tAccessory578\tAccessory410\tAccessory597\tAccessory687\tAccessory599\tAccessory595\t001d000000Hiuy7\n14\tAccessory410\tMTM374\tAccessory688\tAccessory677\tAccessory607\tMTM330\tAccessory729\tMTM405\tAccessory578\tAccessory595\tAccessory449\tAccessory268\tAccessory602\tAccessory599\tAccessory718\tAccessory672\tMTM409\tMTM402\tMTM375\tMTM67\t001b0000002nmH1\n15\tAccessory410\tAccessory607\tAccessory595\tAccessory677\tAccessory468\tAccessory672\tAccessory688\tAccessory579\tAccessory268\tAccessory718\tAccessory591\tMTM330\tMTM67\tAccessory307\tAccessory230\tMTM374\tMTM333\tAccessory729\tAccessory449\tAccessory659\t001d000000Hiw9n\n16\tAccessory688\tAccessory672\tAccessory579\tAccessory607\tAccessory406\tAccessory677\tAccessory594\tAccessory597\tAccessory718\tAccessory84\tMTM352\tAccessory179\tMTM370\tAccessory307\tAccessory347\tAccessory231\tAccessory708\tAccessory658\tAccessory729\tAccessory237\t#N/A\n17\tAccessory718\tAccessory688\tAccessory607\tAccessory677\tAccessory579\tAccessory268\tAccessory591\tMTM331\tAccessory468\tMTM352\tAccessory347\tAccessory406\tAccessory410\tMTM67\tMTM64\tAccessory594\tAccessory597\tAccessory595\tAccessory427\tMTM339\t001b0000003Z64o\n18\tAccessory579\tAccessory688\tAccessory594\tAccessory468\tAccessory597\tAccessory231\tAccessory658\tMTM331\tMTM353\tMTM339\tAccessory307\tAccessory591\tMTM352\tAccessory708\tAccessory659\tAccessory718\tAccessory672\tMTM288\tAccessory691\tMTM67\t001b000003f4Oor\n19\tAccessory410\tAccessory599\tMTM330\tMTM402\tAccessory607\tAccessory688\tAccessory578\tAccessory230\tAccessory595\tMTM234\tAccessory25\tMTM405\tAccessory579\tAccessory597\tAccessory602\tAccessory449\tAccessory319\tAccessory687\tMTM376\tMTM350\t001d000000HivUQ\n20\tAccessory410\tAccessory599\tAccessory579\tMTM330\tAccessory597\tAccessory607\tMTM402\tMTM234\tAccessory595\tAccessory688\tAccessory578\tAccessory230\tAccessory25\tAccessory594\tMTM405\tAccessory449\tMTM350\tAccessory84\tAccessory467\tAccessory602\t001b000000WlVmF\n21\tAccessory579\tAccessory683\tAccessory687\tAccessory230\tAccessory607\tMTM68\tAccessory319\tAccessory513\tMTM65\tMTM402\tAccessory468\tAccessory25\tAccessory202\tAccessory84\tMTM330\tAccessory605\tAccessory406\tAccessory556\tAccessory578\tAccessory598\t001d000000HisHN\n22\tAccessory268\tAccessory595\tAccessory649\tAccessory513\tMTM375\tMTM365\tMTM333\tAccessory743\tAccessory512\tMTM374\tMTM64\tAccessory410\tAccessory702\tAccessory305\tMTM322\tAccessory241\tAccessory347\tAccessory718\tMTM279\tAccessory669\t001d000000HisYo\n23\tAccessory607\tAccessory591\tAccessory688\tAccessory307\tAccessory594\tAccessory468\tAccessory410\tAccessory595\tAccessory597\tMTM332\tAccessory652\tMTM352\tAccessory237\tMTM67\tMTM331\tAccessory406\tAccessory718\tAccessory579\tAccessory289\tAccessory672\t0010X000049HtOb\n24\tAccessory607\tAccessory591\tAccessory688\tAccessory579\tAccessory594\tAccessory410\tAccessory468\tAccessory677\tAccessory307\tMTM352\tAccessory672\tAccessory597\tAccessory718\tAccessory406\tAccessory595\tMTM331\tMTM67\tAccessory659\tAccessory84\tMTM339\t001b0000002nqom\n25\tAccessory594\tAccessory688\tAccessory307\tAccessory597\tAccessory579\tAccessory410\tAccessory591\tAccessory231\tAccessory658\tMTM353\tAccessory672\tMTM339\tMTM331\tAccessory708\tAccessory659\tMTM67\tMTM352\tAccessory691\tAccessory468\tMTM321\t001d000000HiuuO\n26\tAccessory579\tAccessory688\tAccessory683\tAccessory597\tMTM65\tAccessory468\tAccessory513\tAccessory594\tAccessory84\tMTM64\tAccessory598\tAccessory607\tAccessory659\tMTM332\tAccessory677\tMTM402\tAccessory718\tAccessory319\tAccessory202\tAccessory25\t001b000000hc8yM\n27\tAccessory599\tMTM330\tMTM405\tAccessory410\tAccessory578\tAccessory687\tAccessory602\tMTM402\tAccessory607\tMTM234\tAccessory577\tMTM374\tAccessory449\tAccessory595\tMTM376\tMTM350\tAccessory230\tAccessory25\tAccessory729\tAccessory389\t001b000000hc9KE\n28\tMTM402\tAccessory578\tMTM330\tAccessory687\tAccessory607\tAccessory579\tMTM374\tMTM405\tMTM68\tAccessory513\tAccessory319\tAccessory683\tMTM64\tAccessory230\tAccessory25\tAccessory599\tAccessory729\tMTM65\tAccessory677\tAccessory467\t001b0000002nqPQ\n29\tAccessory468\tAccessory410\tAccessory307\tAccessory688\tAccessory579\tAccessory607\tAccessory597\tAccessory595\tAccessory672\tAccessory594\tAccessory231\tAccessory658\tAccessory708\tMTM339\tMTM353\tAccessory659\tAccessory591\tMTM67\tAccessory691\tAccessory718\t001b000000hc8bE\n30\tAccessory607\tAccessory599\tMTM402\tAccessory406\tMTM405\tAccessory687\tAccessory578\tMTM68\tAccessory597\tAccessory467\tAccessory718\tAccessory688\tAccessory7\tMTM65\tAccessory237\tMTM275\tAccessory531\tMTM416\tMTM374\tMTM310\t001b0000002nptM\n31\tAccessory268\tMTM333\tMTM374\tAccessory513\tMTM365\tAccessory347\tMTM340\tMTM64\tAccessory410\tAccessory241\tAccessory512\tMTM375\tAccessory743\tAccessory702\tAccessory669\tMTM328\tAccessory305\tMTM322\tAccessory649\tAccessory551\t001b000000of9f4\n32\tAccessory591\tAccessory688\tMTM331\tAccessory718\tAccessory410\tAccessory594\tAccessory468\tAccessory607\tAccessory579\tMTM352\tMTM67\tAccessory677\tAccessory597\tAccessory268\tAccessory595\tAccessory307\tMTM339\tAccessory652\tAccessory672\tAccessory347\t001d000000HiuZp\n33\tAccessory579\tAccessory688\tAccessory594\tAccessory591\tAccessory410\tAccessory677\tAccessory468\tAccessory597\tAccessory659\tAccessory595\tAccessory607\tMTM332\tAccessory718\tMTM340\tAccessory268\tMTM331\tAccessory652\tAccessory84\tMTM333\tAccessory307\t001d000000HixQz\n34\tAccessory607\tAccessory677\tAccessory718\tAccessory468\tAccessory591\tMTM64\tAccessory406\tAccessory579\tAccessory578\tAccessory688\tMTM332\tAccessory652\tAccessory513\tMTM374\tMTM331\tMTM352\tAccessory268\tMTM330\tAccessory687\tMTM402\t001b000003WAqKa\n35\tAccessory597\tAccessory688\tAccessory579\tMTM353\tAccessory268\tMTM372\tAccessory409\tAccessory691\tMTM365\tAccessory231\tAccessory708\tAccessory512\tAccessory347\tMTM375\tAccessory513\tAccessory649\tAccessory656\tAccessory658\tAccessory743\tAccessory702\t001d000000HixmW\n36\tAccessory607\tAccessory468\tAccessory467\tAccessory579\tMTM64\tAccessory595\tAccessory513\tAccessory718\tAccessory597\tAccessory757\tAccessory688\tAccessory202\tMTM275\tAccessory268\tMTM65\tAccessory683\tMTM332\tAccessory230\tMTM402\tAccessory578\t001b000003Jncze\n37\tAccessory688\tAccessory597\tAccessory467\tAccessory410\tAccessory607\tAccessory579\tMTM402\tAccessory268\tAccessory449\tMTM375\tAccessory718\tMTM64\tAccessory594\tAccessory512\tAccessory578\tAccessory757\tAccessory513\tAccessory307\tMTM234\tAccessory602\t001b000003P7YHr\n38\tAccessory268\tMTM333\tAccessory513\tMTM340\tMTM365\tMTM64\tAccessory512\tMTM375\tAccessory347\tAccessory410\tMTM372\tAccessory702\tMTM287\tAccessory669\tAccessory743\tAccessory688\tMTM322\tAccessory305\tAccessory241\tMTM328\t001b000000hc8Hc\n39\tAccessory607\tAccessory406\tAccessory677\tAccessory718\tAccessory688\tAccessory687\tAccessory579\tMTM330\tAccessory599\tAccessory729\tAccessory594\tAccessory597\tMTM402\tMTM405\tMTM68\tMTM64\tMTM374\tAccessory84\tAccessory578\tAccessory237\t001b0000025kg4V\n40\tAccessory597\tAccessory410\tAccessory595\tAccessory307\tAccessory607\tAccessory467\tAccessory688\tAccessory757\tAccessory449\tAccessory289\tMTM234\tMTM350\tMTM287\tAccessory268\tAccessory599\tMTM332\tMTM333\tAccessory591\tAccessory594\tMTM375\t001b000000wqhaf\n41\tAccessory579\tAccessory410\tAccessory594\tAccessory688\tAccessory677\tAccessory599\tAccessory597\tAccessory84\tMTM330\tAccessory672\tAccessory319\tAccessory307\tAccessory729\tAccessory230\tAccessory659\tAccessory25\tAccessory179\tMTM150\tMTM234\tMTM377\t001b000000da7ON\n42\tAccessory688\tMTM64\tAccessory607\tAccessory597\tAccessory718\tAccessory578\tMTM402\tAccessory467\tAccessory513\tAccessory579\tMTM405\tMTM65\tMTM332\tMTM68\tMTM374\tAccessory406\tMTM330\tAccessory268\tMTM275\tAccessory677\t001b0000003Z5cv\n43\tAccessory231\tMTM353\tAccessory658\tAccessory708\tAccessory691\tAccessory672\tAccessory468\tMTM339\tAccessory579\tAccessory347\tAccessory427\tAccessory659\tMTM321\tAccessory409\tAccessory410\tAccessory656\tAccessory179\tAccessory307\tAccessory130\tMTM67\t001b0000002oLoG\n44\tMTM64\tAccessory607\tAccessory467\tAccessory578\tAccessory718\tAccessory513\tMTM402\tAccessory688\tAccessory268\tMTM374\tAccessory757\tMTM102\tMTM405\tMTM332\tAccessory597\tAccessory241\tMTM68\tMTM275\tAccessory465\tAccessory595\t001b0000002nqz2\n45\tAccessory597\tAccessory688\tAccessory410\tAccessory595\tAccessory467\tAccessory579\tAccessory607\tAccessory591\tAccessory757\tAccessory307\tMTM332\tAccessory594\tAccessory468\tAccessory652\tAccessory289\tAccessory268\tMTM234\tMTM333\tAccessory449\tAccessory659\t001d000000Hiuif\n46\tAccessory688\tAccessory579\tAccessory591\tAccessory594\tAccessory607\tAccessory718\tAccessory597\tAccessory677\tMTM332\tAccessory652\tAccessory406\tMTM64\tAccessory468\tMTM331\tAccessory237\tMTM352\tAccessory598\tAccessory578\tAccessory659\tMTM288\t001b000000wqhPk\n47\tAccessory607\tAccessory410\tAccessory595\tAccessory307\tAccessory230\tAccessory597\tAccessory84\tAccessory672\tAccessory25\tMTM350\tAccessory659\tMTM234\tAccessory599\tAccessory579\tMTM377\tAccessory449\tAccessory231\tAccessory757\tMTM150\tAccessory708\t001b0000002npw8\n48\tAccessory410\tAccessory595\tAccessory591\tAccessory607\tMTM333\tAccessory677\tMTM234\tMTM330\tAccessory578\tMTM350\tAccessory688\tAccessory289\tAccessory449\tAccessory268\tAccessory307\tMTM67\tAccessory599\tMTM340\tAccessory594\tAccessory602\t001b000003XdMd3\n49\tAccessory579\tAccessory231\tMTM353\tAccessory688\tAccessory597\tAccessory718\tAccessory708\tAccessory658\tAccessory691\tAccessory672\tAccessory347\tAccessory268\tMTM339\tAccessory409\tAccessory656\tAccessory427\tMTM321\tMTM372\tAccessory649\tAccessory594\t001b000000hc8DC\n"}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://ip-172-31-0-164.ec2.internal:4040/jobs/job?id=23","http://ip-172-31-0-164.ec2.internal:4040/jobs/job?id=24"],"interpreterSettingId":"spark"}},"apps":[],"jobName":"paragraph_1551442563164_-1291958806","id":"20190227-073122_1630164761","dateCreated":"2019-03-01T12:16:03+0000","dateStarted":"2019-03-01T12:45:21+0000","dateFinished":"2019-03-01T12:45:36+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:15784"},{"text":"/*\n\nAssociation rule\n\n*/\nval col = raw_data.select(\"Quotation: Quotation ID\", \"PRODUCT ID\")\nval basket = col.groupBy(\"Quotation: Quotation ID\").agg(collect_set(\"PRODUCT ID\").alias(\"Product_ID\")).toDF()\nval fpgrowth = new FPGrowth().setItemsCol(\"Product_ID\").setMinSupport(0.001).setMinConfidence(0.5)\nval model_fpgrowth = fpgrowth.fit(basket)\nmodel_fpgrowth.transform(basket)\nval ifThen = model_fpgrowth.associationRules\nifThen.createOrReplaceTempView(\"ifThen\")\nval ifThen_filter = spark.sql(\"select antecedent, consequent, confidence from ifThen where size(antecedent) < 2 and size(consequent) < 2 order by confidence desc\")\nval to_DF = ifThen_filter.select($\"antecedent\"(0).alias(\"antecedent\"),$\"consequent\"(0).alias(\"consequent\"),$\"confidence\")\n","user":"anonymous","dateUpdated":"2019-03-01T12:56:26+0000","config":{"tableHide":true,"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"col: org.apache.spark.sql.DataFrame = [Quotation: Quotation ID: string, PRODUCT ID: string]\nbasket: org.apache.spark.sql.DataFrame = [Quotation: Quotation ID: string, Product_ID: array<string>]\nfpgrowth: org.apache.spark.ml.fpm.FPGrowth = fpgrowth_1e1ce52964b1\nmodel_fpgrowth: org.apache.spark.ml.fpm.FPGrowthModel = fpgrowth_1e1ce52964b1\nres53: org.apache.spark.sql.DataFrame = [Quotation: Quotation ID: string, Product_ID: array<string> ... 1 more field]\nifThen: org.apache.spark.sql.DataFrame = [antecedent: array<string>, consequent: array<string> ... 1 more field]\nifThen_filter: org.apache.spark.sql.DataFrame = [antecedent: array<string>, consequent: array<string> ... 1 more field]\nto_DF: org.apache.spark.sql.DataFrame = [antecedent: string, consequent: string ... 1 more field]\n"}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://ip-172-31-0-164.ec2.internal:4040/jobs/job?id=29","http://ip-172-31-0-164.ec2.internal:4040/jobs/job?id=30","http://ip-172-31-0-164.ec2.internal:4040/jobs/job?id=31"],"interpreterSettingId":"spark"}},"apps":[],"jobName":"paragraph_1551442563166_-407539399","id":"20190104-065514_974613834","dateCreated":"2019-03-01T12:16:03+0000","dateStarted":"2019-03-01T12:56:26+0000","dateFinished":"2019-03-01T12:57:44+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:15785"},{"text":"to_DF.show(20)","user":"anonymous","dateUpdated":"2019-03-01T12:55:00+0000","config":{"tableHide":false,"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+------------+------------+------------------+\n|  antecedent|  consequent|        confidence|\n+------------+------------+------------------+\n|Accessory530|Accessory531| 0.808641975308642|\n|Accessory547|Accessory594|0.7906976744186046|\n|Accessory203|Accessory594|              0.75|\n|Accessory525|Accessory524|0.7466666666666667|\n|Accessory508|Accessory578|0.7213114754098361|\n|Accessory189|Accessory594|0.7164179104477612|\n|Accessory418|Accessory702|0.7142857142857143|\n|Accessory525|Accessory531|0.7066666666666667|\n|Accessory508|Accessory505|0.7049180327868853|\n|Accessory601|Accessory600|               0.7|\n|Accessory728|Accessory600|0.6808510638297872|\n|Accessory533|Accessory531|              0.68|\n|Accessory532|Accessory531|0.6792452830188679|\n|Accessory407|Accessory406|0.6691729323308271|\n|Accessory113|Accessory468|0.6666666666666666|\n|Accessory525|Accessory530|0.6666666666666666|\n|Accessory755|Accessory757|0.6609195402298851|\n|      MTM202|      MTM204|0.6571428571428571|\n|Accessory746|Accessory747|0.6551724137931034|\n|Accessory524|Accessory468|0.6551724137931034|\n+------------+------------+------------------+\nonly showing top 20 rows\n\n"}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://ip-172-31-0-164.ec2.internal:4040/jobs/job?id=28"],"interpreterSettingId":"spark"}},"apps":[],"jobName":"paragraph_1551442563166_179886562","id":"20190227-034014_1037411029","dateCreated":"2019-03-01T12:16:03+0000","dateStarted":"2019-03-01T12:54:58+0000","dateFinished":"2019-03-01T12:56:06+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:15786"}],"name":"Lenovo_Lab_Final","id":"2E5KKKETF","noteParams":{},"noteForms":{},"angularObjects":{"spark:shared_process":[]},"config":{"isZeppelinNotebookCronEnable":false,"looknfeel":"default","personalizedMode":"false"},"info":{}}
