{"paragraphs":[{"text":"import java.io.File\nimport scala.io.Source\njavascript:void(0)\nimport org.apache.log4j.Logger\nimport org.apache.log4j.Level\n\nimport org.apache.spark.SparkConf\nimport org.apache.spark.SparkContext\nimport org.apache.spark.SparkContext._\nimport org.apache.spark.rdd._\nimport org.apache.spark.ml.fpm.FPGrowth\nimport org.apache.spark.mllib.recommendation.{ALS, Rating, MatrixFactorizationModel}\n\n\n","user":"anonymous","dateUpdated":"2018-11-30T09:50:12+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala","tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"import java.io.File\nimport scala.io.Source\nimport org.apache.log4j.Logger\nimport org.apache.log4j.Level\nimport org.apache.spark.SparkConf\nimport org.apache.spark.SparkContext\nimport org.apache.spark.SparkContext._\nimport org.apache.spark.rdd._\nimport org.apache.spark.ml.fpm.FPGrowth\nimport org.apache.spark.mllib.recommendation.{ALS, Rating, MatrixFactorizationModel}\n"}]},"apps":[],"jobName":"paragraph_1543542837601_349420540","id":"20181130-015357_1908866909","dateCreated":"2018-11-30T01:53:57+0000","dateStarted":"2018-11-30T05:38:03+0000","dateFinished":"2018-11-30T05:38:07+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:17365"},{"text":"val transaction = spark.read.option(\"header\",\"true\").csv(\"s3://input-smart-find/Quotations-110818-S.csv\")","user":"anonymous","dateUpdated":"2018-11-30T08:59:32+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala","tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"transaction: org.apache.spark.sql.DataFrame = [Quotation: Quotation ID: string, Quotation: Created Date: string ... 10 more fields]\n"}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://ip-172-31-13-2.ec2.internal:4040/jobs/job?id=0"],"interpreterSettingId":"spark"}},"apps":[],"jobName":"paragraph_1543546746236_-1510747876","id":"20181130-025906_2104350062","dateCreated":"2018-11-30T02:59:06+0000","dateStarted":"2018-11-30T05:38:07+0000","dateFinished":"2018-11-30T05:38:35+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:17366"},{"text":"transaction.printSchema()\nprintln(transaction.first)\ntransaction.show(10)","user":"anonymous","dateUpdated":"2018-11-30T08:59:32+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala","tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"root\n |-- Quotation: Quotation ID: string (nullable = true)\n |-- Quotation: Created Date: string (nullable = true)\n |-- Quotation: Record Type: string (nullable = true)\n |-- Display Net Price Currency: string (nullable = true)\n |-- Display Net Price: string (nullable = true)\n |-- Display Quantity: string (nullable = true)\n |-- Contract Type: string (nullable = true)\n |-- Country: string (nullable = true)\n |-- Account ID: string (nullable = true)\n |-- Proposal Line Item: Line Item Id: string (nullable = true)\n |-- Product: Product Family: string (nullable = true)\n |-- Product: Offering Type: string (nullable = true)\n\n[Q-00024173,17/04/2018,MC,USD,134,1,Multi-Country,Austria,0010X000049HqwDQAS,QL-0001761882,00FE331,MTM]\n+-----------------------+-----------------------+----------------------+--------------------------+-----------------+----------------+-------------+-------+------------------+--------------------------------+-----------------------+----------------------+\n|Quotation: Quotation ID|Quotation: Created Date|Quotation: Record Type|Display Net Price Currency|Display Net Price|Display Quantity|Contract Type|Country|        Account ID|Proposal Line Item: Line Item Id|Product: Product Family|Product: Offering Type|\n+-----------------------+-----------------------+----------------------+--------------------------+-----------------+----------------+-------------+-------+------------------+--------------------------------+-----------------------+----------------------+\n|             Q-00024173|             17/04/2018|                    MC|                       USD|              134|               1|Multi-Country|Austria|0010X000049HqwDQAS|                   QL-0001761882|                00FE331|                   MTM|\n|             Q-00001314|             30/10/2017|                   CPQ|                       NOK|                0|               0|     Quantity| Norway|   0010X000049Hr7j|                   QL-0000027874|             20HD0002MX|                   MTM|\n|             Q-00046480|               2/7/2018|                   CPQ|                       EUR|             7200|              50|     Quantity| France|   001b0000002nq93|                   QL-0003721746|             40AJ0135IT|             Accessory|\n|             Q-00071753|             17/09/2018|                   CPQ|                       EUR|            67900|             100|     Quantity| France|   001b0000002nqUL|                   QL-0005540859|             20JU001GFR|                   MTM|\n|             Q-00002265|             15/11/2017|                   CPQ|                       EUR|              202|               2|     Quantity| France|   001b0000002nqz2|                   QL-0000098440|                40K9612|                   MTM|\n|             Q-00052761|             18/07/2018|                   CPQ|                       EUR|            10000|             100|     Quantity| France|   001b0000003Ws0i|                   QL-0004031341|             ZA2B0037SE|                   MTM|\n|             Q-00074715|             25/09/2018|                   CPQ|                       EUR|            45750|              50|     Quantity|Germany|   001b0000003Z6A3|                   QL-0005862303|             20L7001SGE|                   MTM|\n|             Q-00003868|              5/12/2017|                   CPQ|                       EUR|          9817.41|               1|     Quantity|Germany|   001b0000003Z7Fe|                   QL-0000294940|                93634RX|                   MTM|\n|             Q-00014320|               5/3/2018|                   CPQ|                       EUR|            14925|              25|     Quantity|  Spain|   001b000000PFEyl|                   QL-0001038373|             10MLS49400|                   MTM|\n|             Q-00043494|             24/06/2018|                   CPQ|                       DKK|           607700|              50| Non Quantity|Iceland|   001b000000da7ON|                   QL-0004037436|             30BYS1CK00|                   MTM|\n+-----------------------+-----------------------+----------------------+--------------------------+-----------------+----------------+-------------+-------+------------------+--------------------------------+-----------------------+----------------------+\nonly showing top 10 rows\n\n"}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://ip-172-31-13-2.ec2.internal:4040/jobs/job?id=1","http://ip-172-31-13-2.ec2.internal:4040/jobs/job?id=2"],"interpreterSettingId":"spark"}},"apps":[],"jobName":"paragraph_1543549290394_519647679","id":"20181130-034130_1438264848","dateCreated":"2018-11-30T03:41:30+0000","dateStarted":"2018-11-30T05:38:35+0000","dateFinished":"2018-11-30T05:38:37+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:17367"},{"text":"transaction.count()","user":"anonymous","dateUpdated":"2018-11-30T08:59:32+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala","tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"res20: Long = 147218\n"}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://ip-172-31-13-2.ec2.internal:4040/jobs/job?id=3"],"interpreterSettingId":"spark"}},"apps":[],"jobName":"paragraph_1543549525915_-1032236880","id":"20181130-034525_406570803","dateCreated":"2018-11-30T03:45:25+0000","dateStarted":"2018-11-30T05:38:37+0000","dateFinished":"2018-11-30T05:38:40+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:17368"},{"text":"import org.apache.spark.sql.functions._\nval col = transaction.select(\"Quotation: Quotation ID\", \"Product: Product Family\")\ncol.show(10)\n","user":"anonymous","dateUpdated":"2018-11-30T08:59:33+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala","tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"ERROR","msg":[{"type":"TEXT","data":"import org.apache.spark.sql.functions._\ncol: org.apache.spark.sql.DataFrame = [Quotation: Quotation ID: string, Product: Product Family: string]\n+-----------------------+-----------------------+\n|Quotation: Quotation ID|Product: Product Family|\n+-----------------------+-----------------------+\n|             Q-00024173|                00FE331|\n|             Q-00001314|             20HD0002MX|\n|             Q-00046480|             40AJ0135IT|\n|             Q-00071753|             20JU001GFR|\n|             Q-00002265|                40K9612|\n|             Q-00052761|             ZA2B0037SE|\n|             Q-00074715|             20L7001SGE|\n|             Q-00003868|                93634RX|\n|             Q-00014320|             10MLS49400|\n|             Q-00043494|             30BYS1CK00|\n+-----------------------+-----------------------+\nonly showing top 10 rows\n\n<console>:66: error: value show is not a member of org.apache.spark.sql.RelationalGroupedDataset\n       col.groupBy(col.col(\"Quotation: Quotation ID\")).show()\n                                                       ^\n"}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://ip-172-31-13-2.ec2.internal:4040/jobs/job?id=4"],"interpreterSettingId":"spark"}},"apps":[],"jobName":"paragraph_1543546383582_-1051602986","id":"20181130-025303_1951509482","dateCreated":"2018-11-30T02:53:03+0000","dateStarted":"2018-11-30T05:38:40+0000","dateFinished":"2018-11-30T05:38:42+0000","status":"ERROR","progressUpdateIntervalMs":500,"$$hashKey":"object:17369"},{"text":"val df = col.toDF()\ndf.show(10)\n","user":"anonymous","dateUpdated":"2018-11-30T08:59:33+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala","tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"df: org.apache.spark.sql.DataFrame = [Quotation: Quotation ID: string, Product: Product Family: string]\n+-----------------------+-----------------------+\n|Quotation: Quotation ID|Product: Product Family|\n+-----------------------+-----------------------+\n|             Q-00024173|                00FE331|\n|             Q-00001314|             20HD0002MX|\n|             Q-00046480|             40AJ0135IT|\n|             Q-00071753|             20JU001GFR|\n|             Q-00002265|                40K9612|\n|             Q-00052761|             ZA2B0037SE|\n|             Q-00074715|             20L7001SGE|\n|             Q-00003868|                93634RX|\n|             Q-00014320|             10MLS49400|\n|             Q-00043494|             30BYS1CK00|\n+-----------------------+-----------------------+\nonly showing top 10 rows\n\n"}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://ip-172-31-13-2.ec2.internal:4040/jobs/job?id=5"],"interpreterSettingId":"spark"}},"apps":[],"jobName":"paragraph_1543556909647_-1421765557","id":"20181130-054829_1819412352","dateCreated":"2018-11-30T05:48:29+0000","dateStarted":"2018-11-30T05:50:00+0000","dateFinished":"2018-11-30T05:50:11+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:17370"},{"text":"val basket = df.groupBy(\"Quotation: Quotation ID\").agg(collect_set(\"Product: Product Family\").alias(\"Product_Family\")).toDF()\nval product = basket.select(\"Product_Family\")\n","user":"anonymous","dateUpdated":"2018-11-30T08:59:33+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala","tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"basket: org.apache.spark.sql.DataFrame = [Quotation: Quotation ID: string, Product_Family: array<string>]\nproduct: org.apache.spark.sql.DataFrame = [Product_Family: array<string>]\n"}]},"apps":[],"jobName":"paragraph_1543556988281_781555718","id":"20181130-054948_2014093871","dateCreated":"2018-11-30T05:49:48+0000","dateStarted":"2018-11-30T08:21:44+0000","dateFinished":"2018-11-30T08:21:45+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:17371"},{"text":"product.show(10)\nval fpgrowth = new FPGrowth().setItemsCol(\"Product_Family\").setMinSupport(0.001).setMinConfidence(0.6)\nval model = fpgrowth.fit(product)","user":"anonymous","dateUpdated":"2018-11-30T10:01:26+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala","tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+--------------------+\n|      Product_Family|\n+--------------------+\n|[01DE233, 01DE237...|\n|[00AG520, 49Y7960...|\n|           [0B47395]|\n|[61A8GAT1UK, 10QY...|\n|        [4X40E77324]|\n|[6535EC4, 00WG700...|\n|[4X40K09936, 40A1...|\n|        [20HMS5V700]|\n|        [20J5S38W00]|\n|        [20HUS00X00]|\n+--------------------+\nonly showing top 10 rows\n\nfpgrowth: org.apache.spark.ml.fpm.FPGrowth = fpgrowth_7626548dc7ee\nmodel: org.apache.spark.ml.fpm.FPGrowthModel = fpgrowth_7626548dc7ee\n"}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://ip-172-31-13-2.ec2.internal:4040/jobs/job?id=71","http://ip-172-31-13-2.ec2.internal:4040/jobs/job?id=72","http://ip-172-31-13-2.ec2.internal:4040/jobs/job?id=73"],"interpreterSettingId":"spark"}},"apps":[],"jobName":"paragraph_1543565861115_1771155621","id":"20181130-081741_220636123","dateCreated":"2018-11-30T08:17:41+0000","dateStarted":"2018-11-30T10:01:26+0000","dateFinished":"2018-11-30T10:01:44+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:17372"},{"user":"anonymous","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1543571747477_2120802197","id":"20181130-095547_1224260958","dateCreated":"2018-11-30T09:55:47+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:20312","text":"model.associationRules.show()\nmodel.transform(product).show()","dateUpdated":"2018-11-30T10:16:22+0000","dateFinished":"2018-11-30T10:16:53+0000","dateStarted":"2018-11-30T10:16:22+0000","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+--------------------+------------+------------------+\n|          antecedent|  consequent|        confidence|\n+--------------------+------------+------------------+\n|[0B47097, 4X40E77...|[40AC0135UK]|0.6666666666666666|\n|[0B47097, 4X40E77...|[4XA0E97775]|0.8431372549019608|\n|[0B47097, 4X40E77...|[4X40E77323]|0.7058823529411765|\n|[0B47097, 4X40E77...|[4X90M60789]|0.6862745098039216|\n|[0B47097, 4X40E77...|[4X40E77328]|0.8235294117647058|\n|[7ZT7A00545, 4L67...|[7N67A00883]|0.7878787878787878|\n|[7ZT7A00545, 4L67...|[7XH7A02677]|0.6818181818181818|\n|[0C52862, 40A2009...|[4X40E77328]|0.7058823529411765|\n|[0C52862, 40A2009...|   [0C52861]|0.6911764705882353|\n|[4X40E77322, 4X40...|[40A90090UK]|               1.0|\n|[4X40E77322, 4X40...|[4X90M60789]|               1.0|\n|[4X40E77322, 4X40...|[4X40E77323]|               1.0|\n|[01CV760, 4L67A08...|[7ZT7A00537]|0.7142857142857143|\n|[01CV760, 4L67A08...|[7X77A01304]|0.8367346938775511|\n|[01CV760, 4L67A08...|[7N67A00883]|0.8775510204081632|\n|[7X77A01302, 7X77...|   [46C3447]|0.6176470588235294|\n|[4X40E77322, 40A9...|[40AC0135UK]|0.7777777777777778|\n|[4X40E77322, 40A9...|[4X40E77323]|0.7407407407407407|\n|[4X40E77322, 40A9...|[4XA0E97775]| 0.654320987654321|\n|[4X40E77322, 40A9...|[4X40E77328]|0.8395061728395061|\n+--------------------+------------+------------------+\nonly showing top 20 rows\n\n+--------------------+--------------------+\n|      Product_Family|          prediction|\n+--------------------+--------------------+\n|[01DE233, 01DE237...|                  []|\n|[00AG520, 49Y7960...|           [46W0829]|\n|           [0B47395]|                  []|\n|[61A8GAT1UK, 10QY...|[06P4069, 4X90M60...|\n|        [4X40E77324]|                  []|\n|[6535EC4, 00WG700...|                  []|\n|[4X40K09936, 40A1...|                  []|\n|        [20HMS5V700]|                  []|\n|        [20J5S38W00]|                  []|\n|        [20HUS00X00]|                  []|\n|[4X40E77328, 57Y4...|                  []|\n|        [80XF002KUK]|                  []|\n|[20HCS0QB00, 20JC...|                  []|\n|        [20J8001ESP]|                  []|\n|[20H500B2FR, 40A9...|                  []|\n|        [4XF0H70604]|                  []|\n|[20HF004QED, 20H5...|                  []|\n|[60DFAAT1SA, 80WQ...|                  []|\n|        [81CG020SUK]|                  []|\n|[40A90090EU, 40AC...|        [4X40E77328]|\n+--------------------+--------------------+\nonly showing top 20 rows\n\n"}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://ip-172-31-13-2.ec2.internal:4040/jobs/job?id=84","http://ip-172-31-13-2.ec2.internal:4040/jobs/job?id=85","http://ip-172-31-13-2.ec2.internal:4040/jobs/job?id=86","http://ip-172-31-13-2.ec2.internal:4040/jobs/job?id=87"],"interpreterSettingId":"spark"}}},{"text":"val mostPopularItemInABasket = model.freqItemsets\nmostPopularItemInABasket.createOrReplaceTempView(\"mostPopularItemInABasket\")\n","user":"anonymous","dateUpdated":"2018-11-30T10:02:46+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala","tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"mostPopularItemInABasket: org.apache.spark.sql.DataFrame = [items: array<string>, freq: bigint]\n"}]},"apps":[],"jobName":"paragraph_1543558688401_-1334624538","id":"20181130-061808_871802034","dateCreated":"2018-11-30T06:18:08+0000","dateStarted":"2018-11-30T10:02:46+0000","dateFinished":"2018-11-30T10:02:47+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:17373"},{"text":"%sql\r\nselect items, freq from mostPopularItemInABasket where size(items) >2 order by freq desc limit 20","user":"anonymous","dateUpdated":"2018-11-30T10:02:47+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"items":"string","freq":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false},"multiBarChart":{"rotate":{"degree":"-45"},"xLabelStatus":"default"},"lineChart":{"rotate":{"degree":"-45"},"xLabelStatus":"default"}},"commonSetting":{},"keys":[{"name":"items","index":0,"aggr":"sum"}],"groups":[],"values":[{"name":"freq","index":1,"aggr":"sum"}]},"helium":{}}},"editorSetting":{"language":"sql","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/sql","tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"items\tfreq\nWrappedArray(7N67A00883, 4L67A08366, 7X77A01304)\t133\nWrappedArray(7X77A01303, 7N67A00883, 4L67A08366)\t124\nWrappedArray(4X90M60789, 4X40E77329, 4X40E77328)\t107\nWrappedArray(06P4069, 4XA0E97775, 4X40E77328)\t107\nWrappedArray(7ZT7A00545, 7N67A00883, 4L67A08366)\t106\nWrappedArray(7XH7A02677, 7N67A00883, 4L67A08366)\t102\nWrappedArray(4L47A09133, 7N67A00883, 4L67A08366)\t100\nWrappedArray(7N67A00883, 4L67A08366, 46C3447)\t100\nWrappedArray(4X90M60789, 40A90090EU, 4X40E77328)\t96\nWrappedArray(4X40E77329, 4XA0E97775, 4X40E77328)\t96\nWrappedArray(0C52861, 0C52862, 4X40E77328)\t94\nWrappedArray(40AC0135UK, 40A90090UK, 4X40E77328)\t94\nWrappedArray(4L47A09132, 4L47A09133, 7N67A00883)\t93\nWrappedArray(4X40E77329, 40A90090EU, 4X40E77328)\t93\nWrappedArray(40AG0090EU, 40AJ0135EU, 40AH0135EU)\t93\nWrappedArray(7ZT7A00545, 7X77A01303, 7N67A00883)\t93\nWrappedArray(10QXPAT1UK, 10R0PAT1UK, 10QYPAT1UK)\t89\nWrappedArray(8721ALG, 43W9078, 43W9049)\t88\nWrappedArray(7ZT7A00537, 7X77A01304, 46C3447)\t88\nWrappedArray(0B47069, 4XA0E97775, 4X40E77328)\t87\n"}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://ip-172-31-13-2.ec2.internal:4040/jobs/job?id=78"],"interpreterSettingId":"spark"}},"apps":[],"jobName":"paragraph_1543558898953_-1351388630","id":"20181130-062138_693156040","dateCreated":"2018-11-30T06:21:38+0000","dateStarted":"2018-11-30T10:02:47+0000","dateFinished":"2018-11-30T10:02:55+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:17374"},{"text":"mostPopularItemInABasket.count()","user":"anonymous","dateUpdated":"2018-11-30T10:02:55+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala","tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"res129: Long = 4123\n"}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://ip-172-31-13-2.ec2.internal:4040/jobs/job?id=79"],"interpreterSettingId":"spark"}},"apps":[],"jobName":"paragraph_1543567088630_-1474730475","id":"20181130-083808_486331998","dateCreated":"2018-11-30T08:38:08+0000","dateStarted":"2018-11-30T10:02:55+0000","dateFinished":"2018-11-30T10:03:02+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:17375"},{"text":"val ifThen = model.associationRules\nifThen.createOrReplaceTempView(\"ifThen\")\n","user":"anonymous","dateUpdated":"2018-11-30T10:03:02+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala","tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"ifThen: org.apache.spark.sql.DataFrame = [antecedent: array<string>, consequent: array<string> ... 1 more field]\n"}]},"apps":[],"jobName":"paragraph_1543566578696_786960963","id":"20181130-082938_1045740327","dateCreated":"2018-11-30T08:29:38+0000","dateStarted":"2018-11-30T10:03:02+0000","dateFinished":"2018-11-30T10:03:03+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:17376"},{"text":"%sql\nselect antecedent as `antecedent (if)`, consequent as `consequent (then)`, confidence from ifThen where size(antecedent) < 2 and size(consequent) >2 order by confidence asc limit 20\n","user":"anonymous","dateUpdated":"2018-11-30T10:14:04+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"antecedent (if)":"string","consequent (then)":"string","confidence":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{}}}},"editorSetting":{"language":"sql","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/sql","tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"antecedent (if)\tconsequent (then)\tconfidence\n"}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://ip-172-31-13-2.ec2.internal:4040/jobs/job?id=83"],"interpreterSettingId":"spark"}},"apps":[],"jobName":"paragraph_1543566577001_-173827254","id":"20181130-082937_1508980460","dateCreated":"2018-11-30T08:29:37+0000","dateStarted":"2018-11-30T10:14:04+0000","dateFinished":"2018-11-30T10:14:39+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:17377"},{"text":"ifThen.write.\n    option(\"header\", \"true\").\n    save(\"s3://find-smart-input/arule.csv\")","user":"anonymous","dateUpdated":"2018-11-30T10:03:05+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala","tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"ERROR","msg":[{"type":"TEXT","data":"org.apache.spark.sql.AnalysisException: path s3://find-smart-input/arule.csv already exists.;\n  at org.apache.spark.sql.execution.datasources.InsertIntoHadoopFsRelationCommand.run(InsertIntoHadoopFsRelationCommand.scala:109)\n  at org.apache.spark.sql.execution.command.DataWritingCommandExec.sideEffectResult$lzycompute(commands.scala:104)\n  at org.apache.spark.sql.execution.command.DataWritingCommandExec.sideEffectResult(commands.scala:102)\n  at org.apache.spark.sql.execution.command.DataWritingCommandExec.doExecute(commands.scala:122)\n  at org.apache.spark.sql.execution.SparkPlan$$anonfun$execute$1.apply(SparkPlan.scala:131)\n  at org.apache.spark.sql.execution.SparkPlan$$anonfun$execute$1.apply(SparkPlan.scala:127)\n  at org.apache.spark.sql.execution.SparkPlan$$anonfun$executeQuery$1.apply(SparkPlan.scala:155)\n  at org.apache.spark.rdd.RDDOperationScope$.withScope(RDDOperationScope.scala:151)\n  at org.apache.spark.sql.execution.SparkPlan.executeQuery(SparkPlan.scala:152)\n  at org.apache.spark.sql.execution.SparkPlan.execute(SparkPlan.scala:127)\n  at org.apache.spark.sql.execution.QueryExecution.toRdd$lzycompute(QueryExecution.scala:80)\n  at org.apache.spark.sql.execution.QueryExecution.toRdd(QueryExecution.scala:80)\n  at org.apache.spark.sql.DataFrameWriter$$anonfun$runCommand$1.apply(DataFrameWriter.scala:656)\n  at org.apache.spark.sql.DataFrameWriter$$anonfun$runCommand$1.apply(DataFrameWriter.scala:656)\n  at org.apache.spark.sql.execution.SQLExecution$.withNewExecutionId(SQLExecution.scala:77)\n  at org.apache.spark.sql.DataFrameWriter.runCommand(DataFrameWriter.scala:656)\n  at org.apache.spark.sql.DataFrameWriter.saveToV1Source(DataFrameWriter.scala:273)\n  at org.apache.spark.sql.DataFrameWriter.save(DataFrameWriter.scala:267)\n  at org.apache.spark.sql.DataFrameWriter.save(DataFrameWriter.scala:225)\n  ... 76 elided\n"}]},"apps":[],"jobName":"paragraph_1543568330274_499720950","id":"20181130-085850_1540763718","dateCreated":"2018-11-30T08:58:50+0000","dateStarted":"2018-11-30T10:03:05+0000","dateFinished":"2018-11-30T10:03:07+0000","status":"ERROR","progressUpdateIntervalMs":500,"$$hashKey":"object:17378"},{"text":"spark.sql(\"select * from parquet.`s3://find-smart-input/arule.csv` where confidence > 0.8\").show()","user":"anonymous","dateUpdated":"2018-11-30T09:47:44+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+--------------------+------------+------------------+\n|          antecedent|  consequent|        confidence|\n+--------------------+------------+------------------+\n|           [39Y7916]|   [43W9049]|0.8181818181818182|\n|[7Y37A01093, 4L67...|[7N67A00883]|0.8367346938775511|\n|[0C52861, 0A36536...|   [0C52862]|0.9761904761904762|\n|[0B47045, 4X40E77...|[40AC0135UK]|               1.0|\n|[0B47045, 4X40E77...|[4X40E77328]|               1.0|\n|[0B47045, 0C52862...|[4XA0E97775]|0.8260869565217391|\n|[0B47045, 0C52862...|   [0C52861]|0.8695652173913043|\n|[4L47A09133, 7N67...|[4L47A09132]|0.9473684210526315|\n|[0B47045, 4X40E77...|[4X40E77322]|               1.0|\n|[0B47045, 4X40E77...|[40AC0135UK]|0.9714285714285714|\n|[0B47045, 4X40E77...|[4X40E77323]|               1.0|\n|[40A10065UK, 40AC...|[4X40E77328]|0.8448275862068966|\n|[4X40E77322, 40AC...|[4X40E77323]|0.9487179487179487|\n|[4X40E77322, 40AC...|[4X40E77324]|0.8974358974358975|\n|[4X40E77322, 40AC...|   [0B47045]|0.8717948717948718|\n|[4X40E77322, 4X30...|[4X40E77323]|0.8717948717948718|\n|[4X40E77322, 4X30...|   [06P4069]|0.8717948717948718|\n|[4X40E77322, 4X30...|[40A90090UK]|0.9743589743589743|\n|[4X40E77322, 4X30...|[4X40E77328]|0.9743589743589743|\n|[0B47045, 40AC013...|[4X40E77322]|               1.0|\n+--------------------+------------+------------------+\nonly showing top 20 rows\n\n"}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://ip-172-31-13-2.ec2.internal:4040/jobs/job?id=40","http://ip-172-31-13-2.ec2.internal:4040/jobs/job?id=41"],"interpreterSettingId":"spark"}},"apps":[],"jobName":"paragraph_1543570873100_359774570","id":"20181130-094113_938834290","dateCreated":"2018-11-30T09:41:13+0000","dateStarted":"2018-11-30T09:47:44+0000","dateFinished":"2018-11-30T09:47:46+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:17379"},{"user":"anonymous","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1543571130088_-2072950904","id":"20181130-094530_571852026","dateCreated":"2018-11-30T09:45:30+0000","status":"READY","progressUpdateIntervalMs":500,"$$hashKey":"object:17380"}],"name":"FPGrowth_Arule","id":"2DWD9C7QV","noteParams":{},"noteForms":{},"angularObjects":{"python:shared_process":[],"spark:shared_process":[]},"config":{"isZeppelinNotebookCronEnable":false,"looknfeel":"default","personalizedMode":"false"},"info":{}}