{"paragraphs":[{"text":"import java.io.File\nimport scala.io.Source\nimport org.apache.log4j.Logger\nimport org.apache.log4j.Level\n\nimport org.apache.spark.SparkConf\nimport org.apache.spark.SparkContext\nimport org.apache.spark.SparkContext._\nimport org.apache.spark.rdd._\nimport org.apache.spark.rdd.RDD\nimport org.apache.spark.ml.fpm.FPGrowth\nimport org.apache.spark.mllib.recommendation.ALS\nimport org.apache.spark.mllib.recommendation.MatrixFactorizationModel\nimport org.apache.spark.mllib.recommendation.Rating\nimport org.apache.spark.sql.functions._\n","user":"anonymous","dateUpdated":"2018-12-03T16:08:56+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"import java.io.File\nimport scala.io.Source\nimport org.apache.log4j.Logger\nimport org.apache.log4j.Level\nimport org.apache.spark.SparkConf\nimport org.apache.spark.SparkContext\nimport org.apache.spark.SparkContext._\nimport org.apache.spark.rdd._\nimport org.apache.spark.rdd.RDD\nimport org.apache.spark.ml.fpm.FPGrowth\nimport org.apache.spark.mllib.recommendation.ALS\nimport org.apache.spark.mllib.recommendation.MatrixFactorizationModel\nimport org.apache.spark.mllib.recommendation.Rating\nimport org.apache.spark.sql.functions._\n"}]},"apps":[],"jobName":"paragraph_1543807539159_-288216100","id":"20181203-032539_1948672768","dateCreated":"2018-12-03T03:25:39+0000","dateStarted":"2018-12-03T05:20:30+0000","dateFinished":"2018-12-03T05:20:36+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:1596"},{"text":"import org.apache.spark.sql.functions._\nval rawdata = spark.read.option(\"header\",\"true\").csv(\"s3://input-smart-find/ETL/tr_customer_product.csv\").withColumn(\"rating\", lit(1.0).cast(\"Double\"))\n\n","user":"anonymous","dateUpdated":"2018-12-03T10:25:06+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"import org.apache.spark.sql.functions._\nrawdata: org.apache.spark.sql.DataFrame = [_c0: string, bill_customer: string ... 2 more fields]\n"}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://ip-172-31-7-113.ec2.internal:4040/jobs/job?id=39"],"interpreterSettingId":"spark"}},"apps":[],"jobName":"paragraph_1543807544282_-2134344933","id":"20181203-032544_782512136","dateCreated":"2018-12-03T03:25:44+0000","dateStarted":"2018-12-03T09:53:01+0000","dateFinished":"2018-12-03T09:53:12+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:1597"},{"text":"import org.apache.spark.ml.feature.StringIndexer\nval select = rawdata.drop(\"_c0\")\n\nimport org.apache.spark.ml.feature.StringIndexer\nimport org.apache.spark.ml.feature.VectorAssembler\n val userIndexer = new StringIndexer().setInputCol(\"bill_customer\").setOutputCol(\"user\")\n val indexed = userIndexer.fit(select).transform(select)\n val productIndexer = new StringIndexer().setInputCol(\"items\").setOutputCol(\"product\")\n val whole = productIndexer.fit(indexed).transform(indexed)\n val transform = whole.select(\"user\",\"product\",\"rating\")\n \n\n","user":"anonymous","dateUpdated":"2018-12-03T17:21:38+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"import org.apache.spark.ml.feature.StringIndexer\nselect: org.apache.spark.sql.DataFrame = [bill_customer: string, items: string ... 1 more field]\nimport org.apache.spark.ml.feature.StringIndexer\nimport org.apache.spark.ml.feature.VectorAssembler\nuserIndexer: org.apache.spark.ml.feature.StringIndexer = strIdx_dd9e9d325f1e\nindexed: org.apache.spark.sql.DataFrame = [bill_customer: string, items: string ... 2 more fields]\nproductIndexer: org.apache.spark.ml.feature.StringIndexer = strIdx_c734d4ec69ed\nwhole: org.apache.spark.sql.DataFrame = [bill_customer: string, items: string ... 3 more fields]\ntransform: org.apache.spark.sql.DataFrame = [user: double, product: double ... 1 more field]\n"}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://ip-172-31-7-113.ec2.internal:4040/jobs/job?id=147","http://ip-172-31-7-113.ec2.internal:4040/jobs/job?id=148"],"interpreterSettingId":"spark"}},"apps":[],"jobName":"paragraph_1543845907324_-440613893","id":"20181203-140507_384383764","dateCreated":"2018-12-03T14:05:07+0000","dateStarted":"2018-12-03T17:21:38+0000","dateFinished":"2018-12-03T17:22:46+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:1598"},{"text":"val table = transform.groupBy(\"user\",\"product\").sum(\"rating\").orderBy(asc(\"user\"),asc(\"product\")).toDF()","user":"anonymous","dateUpdated":"2018-12-04T02:10:51+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"table: org.apache.spark.sql.DataFrame = [user: double, product: double ... 1 more field]\n"}]},"apps":[],"jobName":"paragraph_1543887131466_-1128161316","id":"20181204-013211_312690207","dateCreated":"2018-12-04T01:32:11+0000","dateStarted":"2018-12-04T02:10:51+0000","dateFinished":"2018-12-04T02:11:37+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:1599"},{"text":"table.cache()","user":"anonymous","dateUpdated":"2018-12-04T06:12:46+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"res308: table.type = [user: double, product: double ... 1 more field]\n"}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://ip-172-31-7-113.ec2.internal:4040/jobs/job?id=328"],"interpreterSettingId":"spark"}},"apps":[],"jobName":"paragraph_1543903960360_1170870266","id":"20181204-061240_1965613395","dateCreated":"2018-12-04T06:12:40+0000","dateStarted":"2018-12-04T06:12:46+0000","dateFinished":"2018-12-04T06:20:59+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:1600"},{"text":"table.select(table(\"user\")).distinct.count()\ntable.select(table(\"product\")).distinct.count()","user":"anonymous","dateUpdated":"2018-12-04T06:26:19+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"res310: Long = 7836\nres311: Long = 24209\n"}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://ip-172-31-7-113.ec2.internal:4040/jobs/job?id=329","http://ip-172-31-7-113.ec2.internal:4040/jobs/job?id=330"],"interpreterSettingId":"spark"}},"apps":[],"jobName":"paragraph_1543889913829_-74272661","id":"20181204-021833_1793712479","dateCreated":"2018-12-04T02:18:33+0000","dateStarted":"2018-12-04T06:26:19+0000","dateFinished":"2018-12-04T06:44:16+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:1601"},{"text":"import spark.implicits._\nimport org.apache.spark.ml.recommendation.ALS\n\nval Array(training, test) = table.randomSplit(Array(0.8, 0.2))\nval als = new ALS().\nsetSeed(Random.nextLong()).\nsetMaxIter(10).\nsetRank(10).\nsetAlpha(40).\nsetRegParam(0.01).\nsetImplicitPrefs(true).\nsetNonnegative(true).\nsetUserCol(\"user\").\nsetItemCol(\"product\").\nsetRatingCol(\"sum(rating)\")\n\nval model = als.fit(training)\n// model.userFactors.show()\n// model.itemFactors.show()","user":"anonymous","dateUpdated":"2018-12-04T07:06:37+0000","config":{"colWidth":12,"fontSize":9,"enabled":false,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1543858623939_825129587","id":"20181203-173703_569615164","dateCreated":"2018-12-03T17:37:03+0000","dateStarted":"2018-12-04T06:46:06+0000","dateFinished":"2018-12-04T05:50:31+0000","status":"RUNNING","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:1602"},{"text":"whole.show()","user":"anonymous","dateUpdated":"2018-12-04T05:58:59+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+------------------+----------+------+------+-------+\n|     bill_customer|     items|rating|  user|product|\n+------------------+----------+------+------+-------+\n|0010X000049HqwDQAS|   00FE331|   1.0|   3.0| 1037.0|\n|   0010X000049Hr7j|20HD0002MX|   1.0|   0.0|   31.0|\n|   001b0000002nq93|40AJ0135IT|   1.0| 120.0|  477.0|\n|   001b0000002nqUL|20JU001GFR|   1.0|1268.0| 1039.0|\n|   001b0000002nqz2|   40K9612|   1.0|   1.0|  250.0|\n|   001b0000003Ws0i|ZA2B0037SE|   1.0|4733.0|  925.0|\n|   001b0000003Z6A3|20L7001SGE|   1.0|2950.0|  498.0|\n|   001b0000003Z7Fe|   93634RX|   1.0| 752.0|12185.0|\n|   001b000000PFEyl|10MLS49400|   1.0|1027.0|21408.0|\n|   001b000000da7ON|30BYS1CK00|   1.0|  46.0| 9931.0|\n|   001b000000hc8DC|   0B47036|   1.0| 175.0|  152.0|\n|   001b000000hc8Zg|   90Y9412|   1.0|  56.0|  674.0|\n|   001b000000hc9Pu|60G1MAT2SA|   1.0| 656.0|  867.0|\n|   0010X000045cTy8|4X40E77328|   1.0|1577.0|    0.0|\n|0010X000049HqwDQAS|   00FE327|   1.0|   3.0| 2199.0|\n|   0010X000049Hr7j|20HD0002MX|   1.0|   0.0|   31.0|\n|   001b0000002noP7|20HMS0T800|   1.0|3612.0| 5965.0|\n|   001b0000002nq93|40A50230IN|   1.0| 120.0|11702.0|\n|   001b0000002nqUL|40A00065EU|   1.0|1268.0|   73.0|\n|   001b0000002nqz2|   39Y8941|   1.0|   1.0|  464.0|\n+------------------+----------+------+------+-------+\nonly showing top 20 rows\n\n"}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://ip-172-31-7-113.ec2.internal:4040/jobs/job?id=327"],"interpreterSettingId":"spark"}},"apps":[],"jobName":"paragraph_1543902727853_739085069","id":"20181204-055207_1241089230","dateCreated":"2018-12-04T05:52:07+0000","dateStarted":"2018-12-04T05:58:59+0000","dateFinished":"2018-12-04T06:01:44+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:1603"},{"text":"table.count()\r\nval numTraining = training.count()\r\nval numTest = test.count()\r\nprintln(\"Training: \" + numTraining + \" test: \" + numTest)","user":"anonymous","dateUpdated":"2018-12-04T05:38:19+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"numTraining: Long = 67165\nnumTest: Long = 16787\nTraining: 67165 test: 16787\n"}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://ip-172-31-7-113.ec2.internal:4040/jobs/job?id=274","http://ip-172-31-7-113.ec2.internal:4040/jobs/job?id=275","http://ip-172-31-7-113.ec2.internal:4040/jobs/job?id=276","http://ip-172-31-7-113.ec2.internal:4040/jobs/job?id=277"],"interpreterSettingId":"spark"}},"apps":[],"jobName":"paragraph_1543890624561_-1730201151","id":"20181204-023024_178319295","dateCreated":"2018-12-04T02:30:24+0000","dateStarted":"2018-12-04T02:31:00+0000","dateFinished":"2018-12-04T02:34:30+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:1604"},{"text":"//1.查看某用戶接觸過的商品\r\nval userID = 3.0\r\nval existingArtistIDs = training\r\n    .filter($\"user\" === userID)\r\n    .select(\"product\").as[Int].collect()\r\n% sql table.filter($\"user\" isin (existingArtistIDs:_*)).show()//註意這個_*用法","user":"anonymous","dateUpdated":"2018-12-04T06:10:27+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"ERROR","msg":[{"type":"TEXT","data":"userID: Double = 3.0\nexistingArtistIDs: org.apache.spark.sql.Dataset[org.apache.spark.sql.Row] = [user: double, product: double ... 1 more field]\n<console>:1: error: illegal start of definition\n    .filter($\"user\" === userID)\n    ^\n"}]},"apps":[],"jobName":"paragraph_1543903338625_1454357617","id":"20181204-060218_1833070744","dateCreated":"2018-12-04T06:02:18+0000","dateStarted":"2018-12-04T06:05:15+0000","dateFinished":"2018-12-04T06:08:43+0000","status":"ERROR","progressUpdateIntervalMs":500,"$$hashKey":"object:1605"},{"text":"\r\nimport org.apache.spark.sql.functions.explode \r\nval recommendForSubsetDF = model.recommendForUserSubset(test, 40)\r\n\r\nval recommendationsDF = recommendForSubsetDF.select($\"user\", explode($\"recommendations\").alias(\"recommendation\")).select($\"user\", $\"recommendation.*\")\r\n\r\nrecommendationsDF.toDF()","user":"anonymous","dateUpdated":"2018-12-04T04:06:42+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"import org.apache.spark.sql.functions.explode\nrecommendForSubsetDF: org.apache.spark.sql.DataFrame = [user: int, recommendations: array<struct<product:int,rating:float>>]\nrecommendationsDF: org.apache.spark.sql.DataFrame = [user: int, product: int ... 1 more field]\nres293: org.apache.spark.sql.DataFrame = [user: int, product: int ... 1 more field]\n"}]},"apps":[],"jobName":"paragraph_1543895861294_-1844942140","id":"20181204-035741_1037996459","dateCreated":"2018-12-04T03:57:41+0000","dateStarted":"2018-12-04T04:06:42+0000","dateFinished":"2018-12-04T04:09:58+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:1606"},{"text":"recommendationsDF.show()","user":"anonymous","dateUpdated":"2018-12-04T04:13:07+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+----+-------+----------+\n|user|product|    rating|\n+----+-------+----------+\n|1580|     11|  0.780853|\n|1580|     34| 0.7110478|\n|1580|      4| 0.7052887|\n|1580|     37| 0.6941352|\n|1580|     21| 0.6809888|\n|1580|     49|0.67595965|\n|1580|     32| 0.6758438|\n|1580|      5| 0.6717888|\n|1580|     13| 0.6693234|\n|1580|     27| 0.6664329|\n|1580|      0|  0.646383|\n|1580|     62| 0.6439264|\n|1580|    113| 0.6375456|\n|1580|     36|0.62594724|\n|1580|     25| 0.6236673|\n|1580|    123| 0.6181051|\n|1580|     12|0.61415076|\n|1580|    151|   0.61308|\n|1580|    203| 0.6042563|\n|1580|    150|0.59825605|\n+----+-------+----------+\nonly showing top 20 rows\n\n"}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://ip-172-31-7-113.ec2.internal:4040/jobs/job?id=298","http://ip-172-31-7-113.ec2.internal:4040/jobs/job?id=299","http://ip-172-31-7-113.ec2.internal:4040/jobs/job?id=300"],"interpreterSettingId":"spark"}},"apps":[],"jobName":"paragraph_1543896775390_1528431809","id":"20181204-041255_1683060164","dateCreated":"2018-12-04T04:12:55+0000","dateStarted":"2018-12-04T04:13:07+0000","dateFinished":"2018-12-04T04:20:56+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:1607"},{"text":"model.setColdStartStrategy(\"drop\")\nval predictions = model.transform(test)\npredictions.printSchema()\npredictions.show()","user":"anonymous","dateUpdated":"2018-12-04T03:43:11+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"res285: model.type = als_5b82fb44aae0\npredictions: org.apache.spark.sql.DataFrame = [user: double, product: double ... 2 more fields]\nroot\n |-- user: double (nullable = false)\n |-- product: double (nullable = false)\n |-- sum(rating): double (nullable = true)\n |-- prediction: float (nullable = false)\n\n+------+-------+-----------+----------+\n|  user|product|sum(rating)|prediction|\n+------+-------+-----------+----------+\n|2618.0|  148.0|        1.0| 0.5109337|\n| 563.0|  148.0|        4.0| 0.6814673|\n|4011.0|  148.0|        1.0|0.43270543|\n|  58.0|  148.0|        4.0| 1.1239263|\n| 365.0|  148.0|        1.0|0.62294114|\n| 529.0|  148.0|        1.0| 0.7556513|\n|1879.0|  148.0|        1.0|0.66872644|\n|3374.0|  148.0|        1.0|0.41235405|\n| 677.0|  148.0|        5.0| 0.9238698|\n|4001.0|  148.0|        1.0|  0.369113|\n|2187.0|  148.0|        1.0| 0.3082167|\n|1625.0|  148.0|        1.0|0.55794746|\n| 566.0|  148.0|        1.0|0.76785314|\n| 142.0|  463.0|        1.0| 0.6458192|\n|  99.0|  463.0|        4.0|0.70616394|\n| 423.0|  463.0|        1.0|0.70095193|\n|1471.0|  463.0|        3.0|0.38851857|\n| 144.0|  463.0|        1.0| 0.7140647|\n|1638.0|  471.0|        1.0|0.27116978|\n| 882.0|  471.0|        3.0|0.59496367|\n+------+-------+-----------+----------+\nonly showing top 20 rows\n\n"}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://ip-172-31-7-113.ec2.internal:4040/jobs/job?id=296","http://ip-172-31-7-113.ec2.internal:4040/jobs/job?id=297"],"interpreterSettingId":"spark"}},"apps":[],"jobName":"paragraph_1543894777406_-1428151484","id":"20181204-033937_472861655","dateCreated":"2018-12-04T03:39:37+0000","dateStarted":"2018-12-04T03:43:11+0000","dateFinished":"2018-12-04T03:49:31+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:1608"},{"text":"model.setColdStartStrategy(\"drop\")\nval predictions = model.transform(test)\n\nimport org.apache.spark.ml.evaluation.RegressionEvaluator\nval evaluator = new RegressionEvaluator().\nsetMetricName(\"rmse\").\nsetLabelCol(\"sum(rating)\").\nsetPredictionCol(\"prediction\")\nval rmse = evaluator.evaluate(predictions)\nprintln(s\"Root-mean-square error = $rmse\")\n\n// Generate top 10 movie recommendations for each user\nval userRecs = model.recommendForAllUsers(10)\n// Generate top 10 user recommendations for each movie\nval movieRecs = model.recommendForAllItems(10)","user":"anonymous","dateUpdated":"2018-12-04T03:52:40+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"ERROR","msg":[{"type":"TEXT","data":"res281: model.type = als_5b82fb44aae0\npredictions: org.apache.spark.sql.DataFrame = [user: double, product: double ... 2 more fields]\nimport org.apache.spark.ml.evaluation.RegressionEvaluator\nevaluator: org.apache.spark.ml.evaluation.RegressionEvaluator = regEval_e4704ea1b45b\njava.lang.IllegalArgumentException: Field \"rating\" does not exist.\nAvailable fields: user, product, sum(rating), prediction\n  at org.apache.spark.sql.types.StructType$$anonfun$apply$1.apply(StructType.scala:267)\n  at org.apache.spark.sql.types.StructType$$anonfun$apply$1.apply(StructType.scala:267)\n  at scala.collection.MapLike$class.getOrElse(MapLike.scala:128)\n  at scala.collection.AbstractMap.getOrElse(Map.scala:59)\n  at org.apache.spark.sql.types.StructType.apply(StructType.scala:266)\n  at org.apache.spark.ml.util.SchemaUtils$.checkNumericType(SchemaUtils.scala:71)\n  at org.apache.spark.ml.evaluation.RegressionEvaluator.evaluate(RegressionEvaluator.scala:78)\n  ... 150 elided\n"}]},"apps":[],"jobName":"paragraph_1543853983928_-1612664694","id":"20181203-161943_2099055966","dateCreated":"2018-12-03T16:19:43+0000","dateStarted":"2018-12-04T03:33:27+0000","dateFinished":"2018-12-04T03:37:27+0000","status":"ERROR","progressUpdateIntervalMs":500,"$$hashKey":"object:1609"},{"user":"anonymous","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1543816862736_-1517069349","id":"20181203-060102_2001482940","dateCreated":"2018-12-03T06:01:02+0000","status":"READY","progressUpdateIntervalMs":500,"$$hashKey":"object:1610"}],"name":"ALS","id":"2DY3YS8KE","noteParams":{},"noteForms":{},"angularObjects":{"python:shared_process":[],"spark:shared_process":[]},"config":{"isZeppelinNotebookCronEnable":false,"looknfeel":"default","personalizedMode":"false"},"info":{}}